<?xml version="1.0"?><?xml-stylesheet type="text/css" href="fxtran.css"?><object xmlns="http://fxtran.net/#syntax" source-form="FREE" source-width="132" openmp="0" openacc="0"><file name="acpcmt.F90"><C>!OPTIONS XOPT(NOEVAL)</C>
<subroutine-stmt>SUBROUTINE <subroutine-N><N><n>ACPCMT</n></N></subroutine-N> ( <dummy-arg-LT><arg-N><N><n>KIDIA</n></N></arg-N>,<arg-N><N><n>KFDIA</n></N></arg-N>,<arg-N><N><n>KLON</n></N></arg-N>,<arg-N><N><n>KTDIA</n></N></arg-N>,<arg-N><N><n>KLEV</n></N></arg-N>,<arg-N><N><n>KTRA</n></N></arg-N>,<cnt>&amp;</cnt>
  <C>!-----------------------------------------------------------------------</C>
  <C>! - INPUT  2D .</C>
  <cnt>&amp;</cnt> <arg-N><N><n>PALPH</n></N></arg-N>,<arg-N><N><n>PAPHI</n></N></arg-N>,<arg-N><N><n>PAPHIF</n></N></arg-N>,<arg-N><N><n>PAPRS</n></N></arg-N>,<arg-N><N><n>PAPRSF</n></N></arg-N>,<arg-N><N><n>PCP</n></N></arg-N>,<arg-N><N><n>PLH</n></N></arg-N>,<arg-N><N><n>PR</n></N></arg-N>,<cnt>&amp;</cnt>
  <cnt>&amp;</cnt> <arg-N><N><n>PDELP</n></N></arg-N>,<arg-N><N><n>PLNPR</n></N></arg-N>,<cnt>&amp;</cnt>
  <cnt>&amp;</cnt> <arg-N><N><n>PQ</n></N></arg-N>,<arg-N><N><n>PQI</n></N></arg-N>,<arg-N><N><n>PQL</n></N></arg-N>,<arg-N><N><n>PRR</n></N></arg-N>,<arg-N><N><n>PS</n></N></arg-N>,<arg-N><N><n>PQLIS</n></N></arg-N>,<arg-N><N><n>PQSAT</n></N></arg-N>,<arg-N><N><n>PQW</n></N></arg-N>,<cnt>&amp;</cnt>
  <cnt>&amp;</cnt> <arg-N><N><n>PRDELP</n></N></arg-N>,<arg-N><N><n>PCVGQ</n></N></arg-N>,<arg-N><N><n>PT</n></N></arg-N>,<arg-N><N><n>PTW</n></N></arg-N>,<arg-N><N><n>PU</n></N></arg-N>,<arg-N><N><n>PV</n></N></arg-N>,<arg-N><N><n>PTKE</n></N></arg-N>,<arg-N><N><n>PTRA</n></N></arg-N>,<cnt>&amp;</cnt>
  <cnt>&amp;</cnt> <arg-N><N><n>PQLCONV</n></N></arg-N>, <arg-N><N><n>PQICONV</n></N></arg-N> , <arg-N><N><n>PQRCONV</n></N></arg-N>, <arg-N><N><n>PQSCONV</n></N></arg-N>, <cnt>&amp;</cnt>
  <C>! - INPUT 1D .</C>
  <cnt>&amp;</cnt> <arg-N><N><n>PGM</n></N></arg-N>, <arg-N><N><n>PTS</n></N></arg-N>, <arg-N><N><n>PQS</n></N></arg-N>, <arg-N><N><n>PNEIJ</n></N></arg-N>, <arg-N><N><n>PLSM</n></N></arg-N>, <arg-N><N><n>PVETAF</n></N></arg-N>, <cnt>&amp;</cnt>
  <C>! - OUTPUT 2D .</C>
  <cnt>&amp;</cnt> <arg-N><N><n>PDIFCQ</n></N></arg-N>,<arg-N><N><n>PDIFCQL</n></N></arg-N>,<arg-N><N><n>PDIFCQI</n></N></arg-N>,<arg-N><N><n>PDIFCQLC</n></N></arg-N>,<arg-N><N><n>PDIFCQIC</n></N></arg-N>,<arg-N><N><n>PDIFCS</n></N></arg-N>,<arg-N><N><n>PDIFCTH</n></N></arg-N>,<cnt>&amp;</cnt>
  <cnt>&amp;</cnt> <arg-N><N><n>PFCCQL</n></N></arg-N>,<arg-N><N><n>PFCCQN</n></N></arg-N>,<arg-N><N><n>PSTRCU</n></N></arg-N>,<arg-N><N><n>PSTRCV</n></N></arg-N>,<arg-N><N><n>PSTRCTRA</n></N></arg-N>,<cnt>&amp;</cnt>
  <cnt>&amp;</cnt> <arg-N><N><n>PFIMCC</n></N></arg-N>,<arg-N><N><n>PFPEVPCL</n></N></arg-N>,<arg-N><N><n>PFPEVPCN</n></N></arg-N>,<cnt>&amp;</cnt>
  <cnt>&amp;</cnt> <arg-N><N><n>PFPLCL</n></N></arg-N>,<arg-N><N><n>PFPLCN</n></N></arg-N>,<arg-N><N><n>PMF_UP</n></N></arg-N>,<cnt>&amp;</cnt>
  <cnt>&amp;</cnt> <arg-N><N><n>PFPFPCL</n></N></arg-N>,<arg-N><N><n>PFPFPCN</n></N></arg-N>,<cnt>&amp;</cnt>
  <cnt>&amp;</cnt> <arg-N><N><n>PFEDQLC</n></N></arg-N>, <arg-N><N><n>PFEDQIC</n></N></arg-N>, <arg-N><N><n>PFEDQRC</n></N></arg-N>, <arg-N><N><n>PFEDQSC</n></N></arg-N>,<cnt>&amp;</cnt>
  <cnt>&amp;</cnt> <arg-N><N><n>PFCNEGQLC</n></N></arg-N>,<arg-N><N><n>PFCNEGQIC</n></N></arg-N>,<arg-N><N><n>PFCNEGQRC</n></N></arg-N>,<arg-N><N><n>PFCNEGQSC</n></N></arg-N>, <cnt>&amp;</cnt>
  <cnt>&amp;</cnt> <arg-N><N><n>KNLAB</n></N></arg-N>,<cnt>&amp;</cnt>
  <cnt>&amp;</cnt> <arg-N><N><n>PNEBC</n></N></arg-N>,<arg-N><N><n>PQLIC</n></N></arg-N>,<arg-N><N><n>PTU</n></N></arg-N>,<arg-N><N><n>PQU</n></N></arg-N>,<arg-N><N><n>PQC_DET_PCMT</n></N></arg-N>,<arg-N><N><n>PCSGC</n></N></arg-N>, <cnt>&amp;</cnt>
  <C>! - OUTPUT 1D .</C>
  <cnt>&amp;</cnt> <arg-N><N><n>KNND</n></N></arg-N>, <arg-N><N><n>PCAPE</n></N></arg-N>,<arg-N><N><n>PAIPCMT</n></N></arg-N>,<arg-N><N><n>PALF_CAPE</n></N></arg-N>,<arg-N><N><n>PALF_CVGQ</n></N></arg-N>,<cnt>&amp;</cnt>
  <C>! - INPUT/OUTPUT 2D .</C>
  <cnt>&amp;</cnt> <arg-N><N><n>PUDAL</n></N></arg-N>,<arg-N><N><n>PUDOM</n></N></arg-N>,<arg-N><N><n>PDDAL</n></N></arg-N>,<arg-N><N><n>PDDOM</n></N></arg-N></dummy-arg-LT>)</subroutine-stmt>

<C>!**** *ACPCMT * - PCMT CONVECTION SCHEME.</C>

<C>! SUJET.</C>
<C>!     ------</C>

<C>!**   INTERFACE.</C>
<C>!     ----------</C>
<C>!        *CALL* *ACPCMT*</C>
<C>!-----------------------------------------------------------------------</C>
<C>! -   INPUT ARGUMENTS.</C>
<C>!     ----------------</C>

<C>! - PHYSICS DIMENSIONNING PARAMETERS</C>

<C>! KIDIA      : INDICE DE DEPART DES BOUCLES VECTORISEES SUR L'HORIZONT..</C>
<C>! KFDIA      : INDICE DE FIN DES BOUCLES VECTORISEES SUR L'HORIZONTALE.</C>
<C>! KLON       : DIMENSION HORIZONTALE DES TABLEAUX.</C>
<C>! KTDIA      : INDICE DE DEPART DES BOUCLES VERTICALES (1 EN GENERAL).</C>
<C>! KLEV       : DIMENSION VERTICALE DES TABLEAUX &quot;FULL LEVEL&quot;.</C>
<C>! KTRA       : NUMBER OF TRACERS (PASSIVE VARIABLES)</C>

<C>! - PHYSICS VARIABLES (ALPHABETICALLY IN EACH CATEGORY)</C>

<C>! - 2D (0:KLEV) .</C>

<C>! PAPHI      : HALF LEVEL GEOPOTENTIAL</C>
<C>! PAPRS      : HALF LEVEL PRESSURE</C>

<C>! - 2D (1:KLEV) .</C>

<C>! PALPH      : LOG(PAPRS(JLEV)/PAPRSF(JLEV)) (FOR HYDROSTATIC MODEL).</C>
<C>! PAPHIF     : FULL LEVEL GEOPOTENTIAL</C>
<C>! PAPRSF     : FULL LEVEL PRESSURE</C>
<C>! PCP        : CHALEUR MASSIQUE A PRESSION CONSTANTE DE L'AIR.</C>
<C>! PR         : CONSTANTE DE L'AIR HUMIDE.</C>
<C>! PDELP      : PRESSURE DIFFERENCE OVER THE LAYER</C>
<C>! PLNPR      : LOG(PAPRS(JLEV)/PAPRS(JLEV-1)) (POUR L'HYDROSTATIQUE).</C>
<C>! PQ         : MICROPHYSICAL WATER VAPOUR SPECIFIC HUMIDITY</C>
<C>! PQI        : MICROPHYSICAL RESOLVED CLOUD ICE SPECIFIC CONTENT</C>
<C>! PQL        : MICROPHYSICAL RESOLVED CLOUD LIQUID SPECIFIC CONTENT</C>
<C>! PRR        : MICROPHYSICAL RESOLVED RAIN LIQUID SPECIFIC CONTENT</C>
<C>! PS         : MICROPHYSICAL RESOLVED RAIN ICE SPECIFIC CONTENT</C>
<C>! PQLIS      : MICROPHYSICAL RESOLVED CLOUD WATER SPECIFIC CONTENT IN THE TIME-STEP</C>
<C>! PQSAT      : SATURATION SPECIFIC MOISTURE</C>
<C>! PQW        : WET BULB SPECIFIC MOISTURE</C>
<C>! PRDELP     : INVERSE DE L'EPAISSEUR EN PRESSION DE LA COUCHE.</C>
<C>! PCVGQ      : CONVERGENCE D'HUMIDITE.</C>
<C>! PT         : TEMPERATURE.</C>
<C>! PTW        : WET BULB TEMPERATURE.</C>
<C>! PU         : U WIND COMPONENT</C>
<C>! PV         : V WIND COMPONENT</C>
<C>! PTKE       : TKE</C>
<C>! PTRA       : TRACER CONCENTRATION</C>

<C>! - 2D (0:KLEV) .</C>

<C>! - 1D .</C>

<C>! PGM        : FACTEUR D'ECHELLE.</C>
<C>! PTS        : SURFACE LAYER TEMPERATURE.</C>
<C>! PQS        : SURFACE LAYER WATER VAPOUR.</C>
<C>! PNEIJ      : FRACTION OF SOIL COVERED BY SNOW.</C>
<C>! PLSM       : LAND/SEA MASK.</C>
<C>! PVETAF     : VERTICAL COORDINATE.</C>

<C>!-----------------------------------------------------------------------</C>

<C>! -   OUTPUT ARGUMENTS</C>
<C>!     ----------------</C>

<C>! - 2D (0:KLEV) .</C>

<C>! PQLCONV    : LIQUID WATER (CONVECTIVE).</C>
<C>! PQICONV    : ICE    WATER (CONVECTIVE).</C>
<C>! PQRCONV    : RAIN   WATER (CONVECTIVE).</C>
<C>! PQSCONV    : SNOW   WATER (CONVECTIVE).</C>
<C>! PDIFCQ     : FLUX CONVECTIF D'HUMIDITE SPECIFIQUE (HORS PLUIE/NEIGE).</C>
<C>! PDIFCQ     : CONVECTIVE FLUX OF SPECIFIC HUMIDITY (NOT RAIN/SNOW).</C>
<C>! PDIFCQI    : FLUX CONVECTIF D'EAU SOLIDE (HORS PLUIE/NEIGE).</C>
<C>! PDIFCQI    : CONVECTIVE FLUX OF SOLID WATER (NOT RAIN/SNOW).</C>
<C>! PDIFCQL    : FLUX CONVECTIF D'EAU LIQUIDE (HORS PLUIE/NEIGE).</C>
<C>! PDIFCQL    : CONVECTIVE FLUX OF LIQUID WATER (NOT RAIN/SNOW).</C>
<C>! PDIFCQLC   : CONVECTIVE TRANSPORT FLUX OF QLC (LIQUID CONVECTIVE).</C>
<C>! PDIFCQIC   : CONVECTIVE TRANSPORT FLUX OF QIC (ICE CONVECTIVE).</C>
<C>! PDIFCS     : DRY STATIC ENERGY CONVECTIVE FLUX</C>
<C>! PDIFCTH    : THETA CONVECTIVE FLUX</C>
<C>! PFCCQL     : LIQUID CONDENSATION FLUX FROM THE CONVECTIVE UPDRAFT</C>
<C>! PFCCQN     : SOLID CONDENSATION FLUX FROM THE CONVECTIVE UPDRAFT</C>
<C>! PSTRCU     : U-MOMENTUM CONVECTIVE SPECIFIC MOISTURE FLUX</C>
<C>! PSTRCV     : V-MOMENTUM CONVECTIVE SPECIFIC MOISTURE FLUX</C>
<C>! PSTRCTRA   : TRACER CONVECTIVE FLUX</C>
<C>! PFHMLTS    : FLUX DE CHALEUR DU A LA FONTE/GEL.</C>
<C>! PFPEVPCL    : EVAPORATION DES PRECIPITATIONS LIQUIDES.</C>
<C>! PFPEVPCN    : EVAPORATION DES PRECIPITATIONS NEIGEUSES.</C>
<C>! PFPLCL     : PRECIPITATIONS CONVECTIVES SOUS FORME LIQUIDE.</C>
<C>! PFPLCN     : PRECIPITATIONS CONVECTIVES SOUS FORME NEIGE.</C>
<C>! PFPFPCL    : FLUX OF CONVECTIVE PRECIPITATION : THE GENERATION TERM.</C>
<C>! PFPFPCN    : FLUX OF CONVECTIVE PRECIPITATION : THE GENERATION TERM.</C>

<C>! - 2D (1:KLEV) .</C>

<C>! PNEBC  : CONVECTIVE CLOUDINESS.</C>
<C>! PQLIC  : CONVECTIVE CONDENSATE.</C>
<C>! PTU    : TEMPERATURE OF THE CLOUDY ASCENT.</C>
<C>! PQU    : WATER VAPOUR SPECIFIC HUMIDITY OF THE CLOUDY ASCENT.</C>
<C>! PQC_DET_PCMT : CLOUD CONDENSATE (QL+QI) DETRAINED BY PCMT CONVECTION.</C>
<C>! KNLAB  : CONVECTIVE ACTIVITY INDEX (ACTIVE IF EQUAL TO ONE).</C>

<C>! - 1D (DIAGNOSTIQUE) .</C>

<C>! KNND   : ZERO WHENEVER A NON PHYSICAL SITUATION OCCURS, ONE OTHERWISE</C>
<C>! PCAPE  : CAPE (CONDITIONAL AVAILABLE POTENTIAL ENERGY).</C>
<C>! PAIPCMT  : ACTIVITY INDEX OF PCMT: 1. IF PCMT IS ACTIVE, 0. ELSE CASE.</C>

<C>!-----------------------------------------------------------------------</C>

<C>! -   INPUT/OUTPUT ARGUMENTS</C>
<C>!     ----------------------</C>

<C>! - 2D (0:KLEV) .</C>

<C>! - 2D (1:KLEV) .</C>

<C>! PUDAL    : PROGNOSTIC UPDRAFT MESH FRACTION</C>
<C>! PUDOM    : PROGNOSTIC UPDRAFT RELATIVE VELOCITY</C>
<C>! PDDAL    : PROGNOSTIC DOWNDRAFT MESH FRACTION</C>
<C>! PDDOM    : PROGNOSTIC DOWNDRAFT RELATIVE VELOCITY</C>

<C>!-----------------------------------------------------------------------</C>

<C>! METHOD.</C>
<C>!     --------</C>

<C>! AUTHOR.</C>
<C>!     -------</C>
<C>! 2011-12-12, J.M. PIRIOU AND J.F. GUEREMY.</C>

<C>! MODIFICATIONS.</C>
<C>!     --------------</C>
<C>! 2014-04---, D. SAINT-MARTIN : tracer transport.</C>
<C>! 2015-02---, I. BEAU: bugfix (argument PDDOM)</C>
<C>! 2015-09---, J.M PIRIOU: phasing of NWP and CLimate versions</C>
<C>! 2015-11---, J.F. Gueremy: explicit transport flux for the dry air potential temperature</C>
<C>! 2017-06---, J.M. Piriou: replace NTPLUI by KTDIA.</C>

<C>!-----------------------------------------------------------------------</C>


<use-stmt>USE <module-N><N><n>PARKIND1</n></N></module-N>, ONLY : <rename-LT><rename><use-N><N><n>JPIM</n></N></use-N></rename>, <rename><use-N><N><n>JPRB</n></N></use-N></rename></rename-LT></use-stmt>

<use-stmt>USE <module-N><N><n>YOMCST</n></N></module-N>   , ONLY : <rename-LT><rename><use-N><N><n>RG</n></N></use-N></rename>, <rename><use-N><N><n>RCPD</n></N></use-N></rename>, <rename><use-N><N><n>RCS</n></N></use-N></rename>, <rename><use-N><N><n>RCW</n></N></use-N></rename>, <rename><use-N><N><n>RALPD</n></N></use-N></rename>, <rename><use-N><N><n>RALPS</n></N></use-N></rename>,<rename><use-N><N><n>RALPW</n></N></use-N></rename>,<rename><use-N><N><n>RBETD</n></N></use-N></rename>,<rename><use-N><N><n>RBETS</n></N></use-N></rename>, <cnt>&amp;</cnt>
  <cnt>&amp;</cnt> <rename><use-N><N><n>RBETW</n></N></use-N></rename>,<rename><use-N><N><n>RCPV</n></N></use-N></rename>,<rename><use-N><N><n>RDT</n></N></use-N></rename>,<rename><use-N><N><n>RETV</n></N></use-N></rename>,<rename><use-N><N><n>RGAMD</n></N></use-N></rename>,<rename><use-N><N><n>RGAMS</n></N></use-N></rename>,<rename><use-N><N><n>RGAMW</n></N></use-N></rename>,<rename><use-N><N><n>RLSTT</n></N></use-N></rename>,<rename><use-N><N><n>RLVTT</n></N></use-N></rename>,<rename><use-N><N><n>RTT</n></N></use-N></rename>,<rename><use-N><N><n>RV</n></N></use-N></rename></rename-LT></use-stmt>
<use-stmt>USE <module-N><N><n>YOMPHY0</n></N></module-N>  , ONLY : <rename-LT><rename><use-N><N><n>YRPHY0</n></N></use-N></rename></rename-LT></use-stmt>
<use-stmt>USE <module-N><N><n>YOMPHY2</n></N></module-N>  , ONLY : <rename-LT><rename><use-N><N><n>YRPHY2</n></N></use-N></rename></rename-LT></use-stmt>

<use-stmt>USE <module-N><N><n>YOMPHY</n></N></module-N>   , ONLY : <rename-LT><rename><use-N><N><n>YRPHY</n></N></use-N></rename></rename-LT></use-stmt>
<use-stmt>USE <module-N><N><n>YOMSCM</n></N></module-N>   , ONLY : <rename-LT><rename><use-N><N><n>NFRSCM</n></N></use-N></rename></rename-LT></use-stmt>
<use-stmt>USE <module-N><N><n>YOMCT3</n></N></module-N>   , ONLY : <rename-LT><rename><use-N><N><n>NSTEP</n></N></use-N></rename></rename-LT></use-stmt>

<implicit-none-stmt>IMPLICIT NONE</implicit-none-stmt>

<C>!     DUMMY ARGUMENTS.</C>

<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>INTEGER</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPIM</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute> :: <EN-decl-LT><EN-decl><EN-N><N><n>KFDIA</n></N></EN-N></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>INTEGER</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPIM</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute> :: <EN-decl-LT><EN-decl><EN-N><N><n>KIDIA</n></N></EN-N></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>INTEGER</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPIM</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute> :: <EN-decl-LT><EN-decl><EN-N><N><n>KLEV</n></N></EN-N></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>INTEGER</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPIM</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute> :: <EN-decl-LT><EN-decl><EN-N><N><n>KLON</n></N></EN-N></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>INTEGER</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPIM</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute> :: <EN-decl-LT><EN-decl><EN-N><N><n>KTDIA</n></N></EN-N></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>INTEGER</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPIM</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute> :: <EN-decl-LT><EN-decl><EN-N><N><n>KTRA</n></N></EN-N></EN-decl></EN-decl-LT></T-decl-stmt>

<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute>    :: <EN-decl-LT><EN-decl><EN-N><N><n>PALPH</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute>    :: <EN-decl-LT><EN-decl><EN-N><N><n>PAPHI</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><lower-bound><literal-E><l>0</l></literal-E></lower-bound>:<upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute>    :: <EN-decl-LT><EN-decl><EN-N><N><n>PAPHIF</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute>    :: <EN-decl-LT><EN-decl><EN-N><N><n>PAPRS</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><lower-bound><literal-E><l>0</l></literal-E></lower-bound>:<upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute>    :: <EN-decl-LT><EN-decl><EN-N><N><n>PAPRSF</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute>    :: <EN-decl-LT><EN-decl><EN-N><N><n>PCP</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute>    :: <EN-decl-LT><EN-decl><EN-N><N><n>PLH</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute>    :: <EN-decl-LT><EN-decl><EN-N><N><n>PR</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>

<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute>    :: <EN-decl-LT><EN-decl><EN-N><N><n>PDELP</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute>    :: <EN-decl-LT><EN-decl><EN-N><N><n>PLNPR</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>

<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute>    :: <EN-decl-LT><EN-decl><EN-N><N><n>PQ</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute>    :: <EN-decl-LT><EN-decl><EN-N><N><n>PQI</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute>    :: <EN-decl-LT><EN-decl><EN-N><N><n>PQL</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute>    :: <EN-decl-LT><EN-decl><EN-N><N><n>PS</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute>    :: <EN-decl-LT><EN-decl><EN-N><N><n>PRR</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute>    :: <EN-decl-LT><EN-decl><EN-N><N><n>PQLIS</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute>    :: <EN-decl-LT><EN-decl><EN-N><N><n>PQSAT</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute>    :: <EN-decl-LT><EN-decl><EN-N><N><n>PQW</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>

<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute>    :: <EN-decl-LT><EN-decl><EN-N><N><n>PRDELP</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute>    :: <EN-decl-LT><EN-decl><EN-N><N><n>PCVGQ</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute>    :: <EN-decl-LT><EN-decl><EN-N><N><n>PT</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute>    :: <EN-decl-LT><EN-decl><EN-N><N><n>PTW</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute>    :: <EN-decl-LT><EN-decl><EN-N><N><n>PU</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute>    :: <EN-decl-LT><EN-decl><EN-N><N><n>PV</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute>    :: <EN-decl-LT><EN-decl><EN-N><N><n>PTKE</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute>    :: <EN-decl-LT><EN-decl><EN-N><N><n>PTRA</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>, <shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec>, <shape-spec><upper-bound><named-E><N><n>KTRA</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>

<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute>    :: <EN-decl-LT><EN-decl><EN-N><N><n>PQLCONV</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute>    :: <EN-decl-LT><EN-decl><EN-N><N><n>PQICONV</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute>    :: <EN-decl-LT><EN-decl><EN-N><N><n>PQRCONV</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute>    :: <EN-decl-LT><EN-decl><EN-N><N><n>PQSCONV</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>

<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute>    :: <EN-decl-LT><EN-decl><EN-N><N><n>PGM</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute>    :: <EN-decl-LT><EN-decl><EN-N><N><n>PTS</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute>    :: <EN-decl-LT><EN-decl><EN-N><N><n>PQS</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute>    :: <EN-decl-LT><EN-decl><EN-N><N><n>PNEIJ</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute>    :: <EN-decl-LT><EN-decl><EN-N><N><n>PLSM</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>IN</intent-spec>)</attribute>    :: <EN-decl-LT><EN-decl><EN-N><N><n>PVETAF</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>

<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>INOUT</intent-spec>)</attribute>   :: <EN-decl-LT><EN-decl><EN-N><N><n>PDIFCQ</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><lower-bound><literal-E><l>0</l></literal-E></lower-bound>:<upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>INOUT</intent-spec>)</attribute>   :: <EN-decl-LT><EN-decl><EN-N><N><n>PDIFCQL</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><lower-bound><literal-E><l>0</l></literal-E></lower-bound>:<upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>INOUT</intent-spec>)</attribute>   :: <EN-decl-LT><EN-decl><EN-N><N><n>PDIFCQI</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><lower-bound><literal-E><l>0</l></literal-E></lower-bound>:<upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>INOUT</intent-spec>)</attribute>   :: <EN-decl-LT><EN-decl><EN-N><N><n>PDIFCQLC</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><lower-bound><literal-E><l>0</l></literal-E></lower-bound>:<upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>INOUT</intent-spec>)</attribute>   :: <EN-decl-LT><EN-decl><EN-N><N><n>PDIFCQIC</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><lower-bound><literal-E><l>0</l></literal-E></lower-bound>:<upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>INOUT</intent-spec>)</attribute>   :: <EN-decl-LT><EN-decl><EN-N><N><n>PDIFCS</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><lower-bound><literal-E><l>0</l></literal-E></lower-bound>:<upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>INOUT</intent-spec>)</attribute>   :: <EN-decl-LT><EN-decl><EN-N><N><n>PDIFCTH</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><lower-bound><literal-E><l>0</l></literal-E></lower-bound>:<upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>

<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>INOUT</intent-spec>)</attribute>   :: <EN-decl-LT><EN-decl><EN-N><N><n>PFCCQL</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><lower-bound><literal-E><l>0</l></literal-E></lower-bound>:<upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>INOUT</intent-spec>)</attribute>   :: <EN-decl-LT><EN-decl><EN-N><N><n>PFCCQN</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><lower-bound><literal-E><l>0</l></literal-E></lower-bound>:<upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>INOUT</intent-spec>)</attribute>   :: <EN-decl-LT><EN-decl><EN-N><N><n>PSTRCU</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><lower-bound><literal-E><l>0</l></literal-E></lower-bound>:<upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>INOUT</intent-spec>)</attribute>   :: <EN-decl-LT><EN-decl><EN-N><N><n>PSTRCV</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><lower-bound><literal-E><l>0</l></literal-E></lower-bound>:<upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>OUT</intent-spec>)</attribute>   :: <EN-decl-LT><EN-decl><EN-N><N><n>PMF_UP</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><lower-bound><literal-E><l>0</l></literal-E></lower-bound>:<upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>INOUT</intent-spec>)</attribute>   :: <EN-decl-LT><EN-decl><EN-N><N><n>PSTRCTRA</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>, <shape-spec><lower-bound><literal-E><l>0</l></literal-E></lower-bound>:<upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec>, <shape-spec><upper-bound><named-E><N><n>KTRA</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>

<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>INOUT</intent-spec>)</attribute>   :: <EN-decl-LT><EN-decl><EN-N><N><n>PFIMCC</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><lower-bound><literal-E><l>0</l></literal-E></lower-bound>:<upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>INOUT</intent-spec>)</attribute>   :: <EN-decl-LT><EN-decl><EN-N><N><n>PFPEVPCL</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><lower-bound><literal-E><l>0</l></literal-E></lower-bound>:<upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>INOUT</intent-spec>)</attribute>   :: <EN-decl-LT><EN-decl><EN-N><N><n>PFPEVPCN</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><lower-bound><literal-E><l>0</l></literal-E></lower-bound>:<upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>

<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>INOUT</intent-spec>)</attribute>   :: <EN-decl-LT><EN-decl><EN-N><N><n>PFPLCL</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><lower-bound><literal-E><l>0</l></literal-E></lower-bound>:<upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>INOUT</intent-spec>)</attribute>   :: <EN-decl-LT><EN-decl><EN-N><N><n>PFPLCN</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><lower-bound><literal-E><l>0</l></literal-E></lower-bound>:<upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>

<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>INOUT</intent-spec>)</attribute>   :: <EN-decl-LT><EN-decl><EN-N><N><n>PFPFPCL</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><lower-bound><literal-E><l>0</l></literal-E></lower-bound>:<upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>INOUT</intent-spec>)</attribute>   :: <EN-decl-LT><EN-decl><EN-N><N><n>PFPFPCN</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><lower-bound><literal-E><l>0</l></literal-E></lower-bound>:<upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>

<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>   ,<attribute><attribute-N>INTENT</attribute-N>(<intent-spec>INOUT</intent-spec>)</attribute> :: <EN-decl-LT><EN-decl><EN-N><N><n>PFEDQLC</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><lower-bound><literal-E><l>0</l></literal-E></lower-bound>:<upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>   ,<attribute><attribute-N>INTENT</attribute-N>(<intent-spec>INOUT</intent-spec>)</attribute> :: <EN-decl-LT><EN-decl><EN-N><N><n>PFEDQIC</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><lower-bound><literal-E><l>0</l></literal-E></lower-bound>:<upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>   ,<attribute><attribute-N>INTENT</attribute-N>(<intent-spec>INOUT</intent-spec>)</attribute> :: <EN-decl-LT><EN-decl><EN-N><N><n>PFEDQRC</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><lower-bound><literal-E><l>0</l></literal-E></lower-bound>:<upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>   ,<attribute><attribute-N>INTENT</attribute-N>(<intent-spec>INOUT</intent-spec>)</attribute> :: <EN-decl-LT><EN-decl><EN-N><N><n>PFEDQSC</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><lower-bound><literal-E><l>0</l></literal-E></lower-bound>:<upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>

<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>   ,<attribute><attribute-N>INTENT</attribute-N>(<intent-spec>INOUT</intent-spec>)</attribute> :: <EN-decl-LT><EN-decl><EN-N><N><n>PFCNEGQLC</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><lower-bound><literal-E><l>0</l></literal-E></lower-bound>:<upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>   ,<attribute><attribute-N>INTENT</attribute-N>(<intent-spec>INOUT</intent-spec>)</attribute> :: <EN-decl-LT><EN-decl><EN-N><N><n>PFCNEGQIC</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><lower-bound><literal-E><l>0</l></literal-E></lower-bound>:<upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>   ,<attribute><attribute-N>INTENT</attribute-N>(<intent-spec>INOUT</intent-spec>)</attribute> :: <EN-decl-LT><EN-decl><EN-N><N><n>PFCNEGQRC</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><lower-bound><literal-E><l>0</l></literal-E></lower-bound>:<upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>   ,<attribute><attribute-N>INTENT</attribute-N>(<intent-spec>INOUT</intent-spec>)</attribute> :: <EN-decl-LT><EN-decl><EN-N><N><n>PFCNEGQSC</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><lower-bound><literal-E><l>0</l></literal-E></lower-bound>:<upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>

<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>INTEGER</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPIM</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>INOUT</intent-spec>)</attribute> :: <EN-decl-LT><EN-decl><EN-N><N><n>KNLAB</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>INTEGER</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPIM</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>INOUT</intent-spec>)</attribute> :: <EN-decl-LT><EN-decl><EN-N><N><n>KNND</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>

<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>OUT</intent-spec>)</attribute>   :: <EN-decl-LT><EN-decl><EN-N><N><n>PNEBC</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>OUT</intent-spec>)</attribute>   :: <EN-decl-LT><EN-decl><EN-N><N><n>PQLIC</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>OUT</intent-spec>)</attribute>   :: <EN-decl-LT><EN-decl><EN-N><N><n>PTU</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>OUT</intent-spec>)</attribute>   :: <EN-decl-LT><EN-decl><EN-N><N><n>PQU</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>OUT</intent-spec>)</attribute>   :: <EN-decl-LT><EN-decl><EN-N><N><n>PQC_DET_PCMT</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>OUT</intent-spec>)</attribute>   :: <EN-decl-LT><EN-decl><EN-N><N><n>PCSGC</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>

<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>OUT</intent-spec>)</attribute>   :: <EN-decl-LT><EN-decl><EN-N><N><n>PCAPE</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>OUT</intent-spec>)</attribute>   :: <EN-decl-LT><EN-decl><EN-N><N><n>PAIPCMT</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>

<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>OUT</intent-spec>)</attribute>   :: <EN-decl-LT><EN-decl><EN-N><N><n>PALF_CAPE</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>OUT</intent-spec>)</attribute>   :: <EN-decl-LT><EN-decl><EN-N><N><n>PALF_CVGQ</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>

<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>INOUT</intent-spec>)</attribute> :: <EN-decl-LT><EN-decl><EN-N><N><n>PUDAL</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>INOUT</intent-spec>)</attribute> :: <EN-decl-LT><EN-decl><EN-N><N><n>PUDOM</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>INOUT</intent-spec>)</attribute> :: <EN-decl-LT><EN-decl><EN-N><N><n>PDDAL</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>, <attribute><attribute-N>INTENT</attribute-N>(<intent-spec>INOUT</intent-spec>)</attribute> :: <EN-decl-LT><EN-decl><EN-N><N><n>PDDOM</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>

<C>! LOCALS.</C>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_> :: <EN-decl-LT><EN-decl><EN-N><N><n>ZEROV</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>   :: <EN-decl-LT><EN-decl><EN-N><N><n>ZTCVIM</n></N></EN-N></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>   :: <EN-decl-LT><EN-decl><EN-N><N><n>ZICE</n></N></EN-N></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>   :: <EN-decl-LT><EN-decl><EN-N><N><n>ZQRC</n></N></EN-N>   <array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>   :: <EN-decl-LT><EN-decl><EN-N><N><n>ZDDW</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>     <C>! downdraft vertical velocity</C>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>   :: <EN-decl-LT><EN-decl><EN-N><N><n>ZUDQC</n></N></EN-N>  <array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<C>! ZENTR_U    : ENTRAINEMENT DANS L'UPDRAFT.</C>
<C>! ZDETR_U    : DETRAINEMENT DE L'UPDRAFT.</C>
<C>! ZENTR_D    : ENTRAINEMENT DANS LE DOWNDRAFT.</C>
<C>! ZDETR_D    : DETRAINEMENT DU DOWNDRAFT.</C>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_> :: <EN-decl-LT><EN-decl><EN-N><N><n>ZENTR_U</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl>,<EN-decl><EN-N><N><n>ZDETR_U</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_> :: <EN-decl-LT><EN-decl><EN-N><N><n>ZDETR_U_RS</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl>,<EN-decl><EN-N><N><n>ZDETR_D_RS</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_> :: <EN-decl-LT><EN-decl><EN-N><N><n>ZENTR_D</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl>,<EN-decl><EN-N><N><n>ZDETR_D</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_> :: <EN-decl-LT><EN-decl><EN-N><N><n>ZFCCQLTMP</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><lower-bound><literal-E><l>0</l></literal-E></lower-bound>:<upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>   :: <EN-decl-LT><EN-decl><EN-N><N><n>ZQSC</n></N></EN-N>   <array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>   :: <EN-decl-LT><EN-decl><EN-N><N><n>ZQIC</n></N></EN-N>   <array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>   :: <EN-decl-LT><EN-decl><EN-N><N><n>ZQLCONVPREC</n></N></EN-N></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>   :: <EN-decl-LT><EN-decl><EN-N><N><n>ZUDW</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>     <C>! updraft vertical velocity</C>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>   :: <EN-decl-LT><EN-decl><EN-N><N><n>ZQLC</n></N></EN-N>   <array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>INTEGER</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPIM</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_> :: <EN-decl-LT><EN-decl><EN-N><N><n>JLEV</n></N></EN-N></EN-decl>,<EN-decl><EN-N><N><n>JLON</n></N></EN-N></EN-decl>,<EN-decl><EN-N><N><n>INEBC</n></N></EN-N></EN-decl>,<EN-decl><EN-N><N><n>IQLIC</n></N></EN-N></EN-decl>,<EN-decl><EN-N><N><n>IQLIC_MICRO</n></N></EN-N></EN-decl>,<EN-decl><EN-N><N><n>JTRA</n></N></EN-N></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>   :: <EN-decl-LT><EN-decl><EN-N><N><n>ZW_COMPENS</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>     <C>! compensating vertical velocity due to the updraft and downdraft</C>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_>   :: <EN-decl-LT><EN-decl><EN-N><N><n>ZW_CONV</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>     <C>! vertical velocity for cloud transport</C>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_> :: <EN-decl-LT><EN-decl><EN-N><N><n>ZFCCQNTMP</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><lower-bound><literal-E><l>0</l></literal-E></lower-bound>:<upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<C>! ZFHEVPPC   : FLUX DE CHALEUR DU A L'EVAPORATION DES PREC. CONVECTIVES.</C>
<C>! ZFHMLTSC   : FLUX DE CHALEUR DU A LA FONTE/GEL DES PREC. CONVECTIVES.</C>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_> :: <EN-decl-LT><EN-decl><EN-N><N><n>ZFHEVPPC</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><lower-bound><literal-E><l>0</l></literal-E></lower-bound>:<upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl>,<EN-decl><EN-N><N><n>ZFHMLTSC</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><lower-bound><literal-E><l>0</l></literal-E></lower-bound>:<upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<C>! ZQLIC_MICRO: convective condensate, to be used in microphysics (evaporation, etc).</C>
<C>! ZNEBC_MICRO: convective cloudiness, to be used in microphysics (evaporation, etc).</C>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_> :: <EN-decl-LT><EN-decl><EN-N><N><n>ZQLIC_MICRO</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl>,<EN-decl><EN-N><N><n>ZNEBC_MICRO</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl>,<EN-decl><EN-N><N><n>ZDAL</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_> :: <EN-decl-LT><EN-decl><EN-N><N><n>ZQLCED</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl>,<EN-decl><EN-N><N><n>ZQICED</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_> :: <EN-decl-LT><EN-decl><EN-N><N><n>ZQ_COND_XR96</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt> <C>! QLC+QIC+QRC+QSC, FOR USE IN THE XU-RANDALL CLOUDINESS.</C>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_> :: <EN-decl-LT><EN-decl><EN-N><N><n>ZCCHSL</n></N></EN-N></EN-decl>,<EN-decl><EN-N><N><n>ZCCHSN</n></N></EN-N></EN-decl>,<EN-decl><EN-N><N><n>ZEPS</n></N></EN-N></EN-decl></EN-decl-LT></T-decl-stmt>
<C>!REAL(KIND=JPRB) :: ZMAX(KLON)</C>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_> :: <EN-decl-LT><EN-decl><EN-N><N><n>ZDEPTH</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_> :: <EN-decl-LT><EN-decl><EN-N><N><n>ZTMPVAR</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt>

<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_> :: <EN-decl-LT><EN-decl><EN-N><N><n>ZTMIC</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt> <C>! Temperature for microphysics</C>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_> :: <EN-decl-LT><EN-decl><EN-N><N><n>ZQMIC</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt> <C>! Specific moisture for microphysics</C>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_> :: <EN-decl-LT><EN-decl><EN-N><N><n>ZEVAPO</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt> <C>! Evaporation from previous time step.</C>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_> :: <EN-decl-LT><EN-decl><EN-N><N><n>ZSU</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec>,<shape-spec><upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt> <C>! Energie statique seche de l'updraft.</C>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_> :: <EN-decl-LT><EN-decl><EN-N><N><n>ZALF</n></N></EN-N><array-spec>(<shape-spec-LT><shape-spec><upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></shape-spec></shape-spec-LT>)</array-spec></EN-decl></EN-decl-LT></T-decl-stmt> <C>! Prognostic active surface fraction.</C>
<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>REAL</T-N><K-selector>(<K-spec-spec><K-spec><arg-N n="KIND"><k>KIND</k></arg-N>=<named-E><N><n>JPRB</n></N></named-E></K-spec></K-spec-spec>)</K-selector></intrinsic-T-spec></_T-spec_> :: <EN-decl-LT><EN-decl><EN-N><N><n>ZFRACP</n></N></EN-N></EN-decl>,<EN-decl><EN-N><N><n>ZTH</n></N></EN-N></EN-decl></EN-decl-LT></T-decl-stmt>

<T-decl-stmt><_T-spec_><intrinsic-T-spec><T-N>LOGICAL</T-N></intrinsic-T-spec></_T-spec_>         :: <EN-decl-LT><EN-decl><EN-N><N><n>LLADJCLD</n></N></EN-N></EN-decl></EN-decl-LT></T-decl-stmt>

<include>#include &quot;<filename>acadvec.intfb.h</filename>&quot;</include>
<include>#include &quot;<filename>acmtentr.intfb.h</filename>&quot;</include>
<include>#include &quot;<filename>acmtud.intfb.h</filename>&quot;</include>
<include>#include &quot;<filename>acpluiz.intfb.h</filename>&quot;</include>
<include>#include &quot;<filename>acnebxrs.intfb.h</filename>&quot;</include>
<include>#include &quot;<filename>fcttrm.func.h</filename>&quot;</include>
<include>#include &quot;<filename>fctdoi.func.h</filename>&quot;</include>



<a-stmt><E-1><named-E><N><n>ZEPS</n></N></named-E></E-1><a>=</a><E-2><literal-E><l>1.E-12</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></E-2></a-stmt>
<a-stmt><E-1><named-E><N><n>ZCCHSL</n></N></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>RCW</n></N></named-E><op><o>-</o></op><named-E><N><n>RCPD</n></N></named-E></op-E></E-2></a-stmt>
<a-stmt><E-1><named-E><N><n>ZCCHSN</n></N></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>RCS</n></N></named-E><op><o>-</o></op><named-E><N><n>RCPD</n></N></named-E></op-E></E-2></a-stmt>
<do-stmt>DO <do-V><named-E><N><n>JLEV</n></N></named-E></do-V> = <lower-bound><literal-E><l>0</l></literal-E></lower-bound>, <upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></do-stmt>
<do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V> = <lower-bound><literal-E><l>1</l></literal-E></lower-bound>, <upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></do-stmt>
<a-stmt><E-1><named-E><N><n>PFIMCC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a> <E-2><literal-E><l>0.</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></E-2></a-stmt>
<end-do-stmt>ENDDO</end-do-stmt>
<end-do-stmt>ENDDO</end-do-stmt>

<do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V> = <lower-bound><literal-E><l>1</l></literal-E></lower-bound>, <upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></do-stmt>
<a-stmt><E-1><named-E><N><n>ZDAL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a> <E-2><literal-E><l>0.</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></E-2></a-stmt>
<end-do-stmt>ENDDO</end-do-stmt>

<do-stmt>DO <do-V><named-E><N><n>JLEV</n></N></named-E></do-V> = <lower-bound><literal-E><l>1</l></literal-E></lower-bound>, <upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></do-stmt>
<do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V> = <lower-bound><literal-E><l>1</l></literal-E></lower-bound>, <upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></do-stmt>
<a-stmt><E-1><named-E><N><n>PQC_DET_PCMT</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a> <E-2><literal-E><l>0.</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></E-2></a-stmt>
<end-do-stmt>ENDDO</end-do-stmt>
<end-do-stmt>ENDDO</end-do-stmt>


<do-stmt>DO <do-V><named-E><N><n>JLEV</n></N></named-E></do-V> = <lower-bound><literal-E><l>1</l></literal-E></lower-bound>, <upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></do-stmt>
<do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V> = <lower-bound><literal-E><l>1</l></literal-E></lower-bound>, <upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></do-stmt>
<a-stmt><E-1><named-E><N><n>ZEVAPO</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a> <E-2><literal-E><l>0.</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></E-2></a-stmt>
<end-do-stmt>ENDDO</end-do-stmt>
<end-do-stmt>ENDDO</end-do-stmt>

<if-then-stmt>IF(<condition-E><named-E><N><n>YRPHY0</n></N><R-LT><component-R>%<ct>LCVNHD</ct></component-R></R-LT></named-E></condition-E>) THEN</if-then-stmt>
  <C>! Evaporation from previous time step is got from the PDDAL buffer.</C>
  <do-stmt>DO <do-V><named-E><N><n>JLEV</n></N></named-E></do-V> = <lower-bound><named-E><N><n>KTDIA</n></N></named-E></lower-bound>, <upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></do-stmt>
  <do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V> = <lower-bound><named-E><N><n>KIDIA</n></N></named-E></lower-bound>, <upper-bound><named-E><N><n>KFDIA</n></N></named-E></upper-bound></do-stmt>
  <a-stmt><E-1><named-E><N><n>ZEVAPO</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><named-E><N><n>PDDAL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-2></a-stmt>
  <end-do-stmt>ENDDO</end-do-stmt>
  <end-do-stmt>ENDDO</end-do-stmt>
<end-if-stmt>ENDIF</end-if-stmt>

<C>! UDPDRAFT.</C>
<call-stmt>CALL <procedure-designator><named-E><N><n>ACMTUD</n></N></named-E></procedure-designator> ( <arg-spec><arg><named-E><N><n>KIDIA</n></N></named-E></arg>,<arg><named-E><N><n>KFDIA</n></N></named-E></arg>,<arg><named-E><N><n>KLON</n></N></named-E></arg>,<arg><named-E><N><n>KTDIA</n></N></named-E></arg>,<arg><named-E><N><n>KLEV</n></N></named-E></arg>,<arg><named-E><N><n>KTRA</n></N></named-E></arg>,<cnt>&amp;</cnt>
  <cnt>&amp;</cnt> <arg><named-E><N><n>PALPH</n></N></named-E></arg>, <arg><named-E><N><n>PAPHI</n></N></named-E></arg>, <arg><named-E><N><n>PAPHIF</n></N></named-E></arg>, <arg><named-E><N><n>PAPRS</n></N></named-E></arg>, <arg><named-E><N><n>PAPRSF</n></N></named-E></arg>, <arg><named-E><N><n>PCP</n></N></named-E></arg>,<arg><named-E><N><n>PLH</n></N></named-E></arg>, <arg><named-E><N><n>PR</n></N></named-E></arg>,<cnt>&amp;</cnt>
  <cnt>&amp;</cnt> <arg><named-E><N><n>PDELP</n></N></named-E></arg>, <arg><named-E><N><n>PLNPR</n></N></named-E></arg>,<cnt>&amp;</cnt>
  <cnt>&amp;</cnt> <arg><named-E><N><n>PQ</n></N></named-E></arg>, <arg><named-E><N><n>PQI</n></N></named-E></arg>, <arg><named-E><N><n>PQL</n></N></named-E></arg>, <arg><named-E><N><n>PQLIS</n></N></named-E></arg>, <arg><named-E><N><n>PQSAT</n></N></named-E></arg>, <arg><named-E><N><n>PQW</n></N></named-E></arg>,<cnt>&amp;</cnt>
  <cnt>&amp;</cnt> <arg><named-E><N><n>PRDELP</n></N></named-E></arg>, <arg><named-E><N><n>PCVGQ</n></N></named-E></arg>,<arg><named-E><N><n>PT</n></N></named-E></arg>, <arg><named-E><N><n>PTW</n></N></named-E></arg>, <arg><named-E><N><n>PU</n></N></named-E></arg>, <arg><named-E><N><n>PV</n></N></named-E></arg>, <arg><named-E><N><n>PTKE</n></N></named-E></arg>, <arg><named-E><N><n>PTRA</n></N></named-E></arg>,<arg><named-E><N><n>ZEVAPO</n></N></named-E></arg>, <cnt>&amp;</cnt>
  <cnt>&amp;</cnt> <arg><named-E><N><n>PGM</n></N></named-E></arg>,<arg><named-E><N><n>PTS</n></N></named-E></arg>,<arg><named-E><N><n>PQS</n></N></named-E></arg>,<cnt>&amp;</cnt>
  <cnt>&amp;</cnt> <arg><named-E><N><n>PDIFCQ</n></N></named-E></arg>, <arg><named-E><N><n>PDIFCQL</n></N></named-E></arg>, <arg><named-E><N><n>PDIFCQI</n></N></named-E></arg>, <arg><named-E><N><n>PDIFCS</n></N></named-E></arg>, <arg><named-E><N><n>PDIFCTH</n></N></named-E></arg>,<cnt>&amp;</cnt>
  <cnt>&amp;</cnt> <arg><named-E><N><n>PFCCQL</n></N></named-E></arg>, <arg><named-E><N><n>PFCCQN</n></N></named-E></arg>, <arg><named-E><N><n>PSTRCU</n></N></named-E></arg>, <arg><named-E><N><n>PSTRCV</n></N></named-E></arg>, <arg><named-E><N><n>PSTRCTRA</n></N></named-E></arg>,<cnt>&amp;</cnt>
  <cnt>&amp;</cnt> <arg><named-E><N><n>ZFHMLTSC</n></N></named-E></arg>,<arg><named-E><N><n>ZFHEVPPC</n></N></named-E></arg>,<arg><named-E><N><n>PFPEVPCL</n></N></named-E></arg>,<arg><named-E><N><n>PFPEVPCN</n></N></named-E></arg>,<cnt>&amp;</cnt>
  <cnt>&amp;</cnt> <arg><named-E><N><n>PFPLCL</n></N></named-E></arg>,<arg><named-E><N><n>PFPLCN</n></N></named-E></arg>,<arg><named-E><N><n>PMF_UP</n></N></named-E></arg>,<cnt>&amp;</cnt>
  <cnt>&amp;</cnt> <arg><named-E><N><n>PNEBC</n></N></named-E></arg>,<arg><named-E><N><n>PQLIC</n></N></named-E></arg>,<arg><named-E><N><n>PTU</n></N></named-E></arg>,<arg><named-E><N><n>PQU</n></N></named-E></arg>,<arg><named-E><N><n>ZSU</n></N></named-E></arg>,<arg><named-E><N><n>KNLAB</n></N></named-E></arg>,<arg><named-E><N><n>ZENTR_U</n></N></named-E></arg>,<arg><named-E><N><n>ZDETR_U</n></N></named-E></arg>,<arg><named-E><N><n>ZENTR_D</n></N></named-E></arg>,<arg><named-E><N><n>ZDETR_D</n></N></named-E></arg>,<cnt>&amp;</cnt>
  <cnt>&amp;</cnt> <arg><named-E><N><n>KNND</n></N></named-E></arg>,<arg><named-E><N><n>PCAPE</n></N></named-E></arg>, <arg><named-E><N><n>ZALF</n></N></named-E></arg>, <arg><named-E><N><n>PALF_CAPE</n></N></named-E></arg>, <arg><named-E><N><n>PALF_CVGQ</n></N></named-E></arg>,<cnt>&amp;</cnt>
  <cnt>&amp;</cnt> <arg><named-E><N><n>PUDAL</n></N></named-E></arg>,<arg><named-E><N><n>PUDOM</n></N></named-E></arg>,<arg><named-E><N><n>PDDAL</n></N></named-E></arg>,<arg><named-E><N><n>PDDOM</n></N></named-E></arg></arg-spec>)</call-stmt>

<if-then-stmt>IF(<condition-E><op-E><named-E><N><n>YRPHY0</n></N><R-LT><component-R>%<ct>NCVQLI</ct></component-R></R-LT></named-E> <op><o>==</o></op> <literal-E><l>2</l></literal-E></op-E></condition-E>) THEN</if-then-stmt>
  <C>! Radiative condensates and cloudiness, due to convection, computed as ql+qi+qr+qs.</C>
  <do-stmt>DO <do-V><named-E><N><n>JLEV</n></N></named-E></do-V> = <lower-bound><named-E><N><n>KTDIA</n></N></named-E></lower-bound>, <upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></do-stmt>
    <do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V> = <lower-bound><named-E><N><n>KIDIA</n></N></named-E></lower-bound>, <upper-bound><named-E><N><n>KFDIA</n></N></named-E></upper-bound></do-stmt>
      <a-stmt><E-1><named-E><N><n>PQLIC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>PQL</n><cnt>&amp;</cnt>
<cnt>&amp;</cnt><n>CONV</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>+</o></op><op-E><named-E><N><n>PQICONV</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E> <cnt>&amp;</cnt>
        <cnt>&amp;</cnt> <op><o>+</o></op><op-E><named-E><N><n>PQRCONV</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>+</o></op><named-E><N><n>PQSCONV</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></op-E></op-E></E-2></a-stmt>
      <a-stmt><E-1><named-E><N><n>PNEBC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>PUDAL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>YRPHY0</n></N><R-LT><component-R>%<ct>FNEBC</ct></component-R></R-LT></named-E></op-E></E-2></a-stmt>
    <end-do-stmt>ENDDO</end-do-stmt>
  <end-do-stmt>ENDDO</end-do-stmt>
<end-if-stmt>ENDIF</end-if-stmt>

<C>! INITIALIZE CONVECTIVE PROFILES: INTRA-TIME-STEP EVOLUTION.</C>
<do-stmt>DO <do-V><named-E><N><n>JLEV</n></N></named-E></do-V> = <lower-bound><literal-E><l>1</l></literal-E></lower-bound>, <upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></do-stmt>
<do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V> = <lower-bound><literal-E><l>1</l></literal-E></lower-bound>, <upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></do-stmt>
<a-stmt><E-1><named-E><N><n>ZQLC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a> <E-2><named-E><N><n>PQLCONV</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-2></a-stmt>
<end-do-stmt>ENDDO</end-do-stmt>
<end-do-stmt>ENDDO</end-do-stmt>

<do-stmt>DO <do-V><named-E><N><n>JLEV</n></N></named-E></do-V> = <lower-bound><literal-E><l>1</l></literal-E></lower-bound>, <upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></do-stmt>
<do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V> = <lower-bound><literal-E><l>1</l></literal-E></lower-bound>, <upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></do-stmt>
<a-stmt><E-1><named-E><N><n>ZQIC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a> <E-2><named-E><N><n>PQICONV</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-2></a-stmt>
<end-do-stmt>ENDDO</end-do-stmt>
<end-do-stmt>ENDDO</end-do-stmt>

<do-stmt>DO <do-V><named-E><N><n>JLEV</n></N></named-E></do-V> = <lower-bound><literal-E><l>1</l></literal-E></lower-bound>, <upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></do-stmt>
<do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V> = <lower-bound><literal-E><l>1</l></literal-E></lower-bound>, <upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></do-stmt>
<a-stmt><E-1><named-E><N><n>ZQRC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a> <E-2><named-E><N><n>PQRCONV</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-2></a-stmt>
<end-do-stmt>ENDDO</end-do-stmt>
<end-do-stmt>ENDDO</end-do-stmt>

<do-stmt>DO <do-V><named-E><N><n>JLEV</n></N></named-E></do-V> = <lower-bound><literal-E><l>1</l></literal-E></lower-bound>, <upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></do-stmt>
<do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V> = <lower-bound><literal-E><l>1</l></literal-E></lower-bound>, <upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></do-stmt>
<a-stmt><E-1><named-E><N><n>ZQSC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a> <E-2><named-E><N><n>PQSCONV</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-2></a-stmt>
<end-do-stmt>ENDDO</end-do-stmt>
<end-do-stmt>ENDDO</end-do-stmt>


<C>!-------------------------------------------------</C>
<C>! ENTRAINMENT AND DETRAINMENT.</C>
<C>!-------------------------------------------------</C>

<call-stmt>CALL <procedure-designator><named-E><N><n>ACMTENTR</n></N></named-E></procedure-designator>(<arg-spec><arg><named-E><N><n>KIDIA</n></N></named-E></arg>, <arg><named-E><N><n>KFDIA</n></N></named-E></arg>, <arg><named-E><N><n>KLON</n></N></named-E></arg>, <arg><named-E><N><n>KTDIA</n></N></named-E></arg>, <arg><named-E><N><n>KLEV</n></N></named-E></arg>, <arg><named-E><N><n>PDELP</n></N></named-E></arg>, <arg><named-E><N><n>ZQLC</n></N></named-E></arg>, <arg><named-E><N><n>PQL</n></N></named-E></arg>, <arg><named-E><N><n>PUDAL</n></N></named-E></arg>, <arg><named-E><N><n>PDDAL</n></N></named-E></arg>, <cnt>&amp;</cnt>
  <cnt>&amp;</cnt> <arg><named-E><N><n>ZENTR_U</n></N></named-E></arg>, <arg><named-E><N><n>ZENTR_D</n></N></named-E></arg>, <arg><named-E><N><n>ZDETR_U</n></N></named-E></arg>, <arg><named-E><N><n>ZDETR_D</n></N></named-E></arg>, <arg><named-E><N><n>PFEDQLC</n></N></named-E></arg></arg-spec>)</call-stmt>
<call-stmt>CALL <procedure-designator><named-E><N><n>ACMTENTR</n></N></named-E></procedure-designator>(<arg-spec><arg><named-E><N><n>KIDIA</n></N></named-E></arg>, <arg><named-E><N><n>KFDIA</n></N></named-E></arg>, <arg><named-E><N><n>KLON</n></N></named-E></arg>, <arg><named-E><N><n>KTDIA</n></N></named-E></arg>, <arg><named-E><N><n>KLEV</n></N></named-E></arg>, <arg><named-E><N><n>PDELP</n></N></named-E></arg>, <arg><named-E><N><n>ZQIC</n></N></named-E></arg>, <arg><named-E><N><n>PQI</n></N></named-E></arg>, <arg><named-E><N><n>PUDAL</n></N></named-E></arg>, <arg><named-E><N><n>PDDAL</n></N></named-E></arg>, <cnt>&amp;</cnt>
  <cnt>&amp;</cnt> <arg><named-E><N><n>ZENTR_U</n></N></named-E></arg>, <arg><named-E><N><n>ZENTR_D</n></N></named-E></arg>, <arg><named-E><N><n>ZDETR_U</n></N></named-E></arg>, <arg><named-E><N><n>ZDETR_D</n></N></named-E></arg>, <arg><named-E><N><n>PFEDQIC</n></N></named-E></arg></arg-spec>)</call-stmt>
<C>! Detrainment of rain and snow is smaller from that of lagrangian species (liquid and ice).</C>
<do-stmt>DO <do-V><named-E><N><n>JLEV</n></N></named-E></do-V> = <lower-bound><op-E><named-E><N><n>KTDIA</n></N></named-E><op><o>-</o></op><literal-E><l>1</l></literal-E></op-E></lower-bound>, <upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></do-stmt>
  <do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V> = <lower-bound><named-E><N><n>KIDIA</n></N></named-E></lower-bound>, <upper-bound><named-E><N><n>KFDIA</n></N></named-E></upper-bound></do-stmt>
    <a-stmt><E-1><named-E><N><n>ZDETR_U_RS</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>YRPHY0</n></N><R-LT><component-R>%<ct>GREDDRS</ct></component-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>ZDETR_U</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></E-2></a-stmt>
    <a-stmt><E-1><named-E><N><n>ZDETR_D_RS</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>YRPHY0</n></N><R-LT><component-R>%<ct>GREDDRS</ct></component-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>ZDETR_D</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></E-2></a-stmt>
  <end-do-stmt>ENDDO</end-do-stmt>
<end-do-stmt>ENDDO</end-do-stmt>
<call-stmt>CALL <procedure-designator><named-E><N><n>ACMTENTR</n></N></named-E></procedure-designator>(<arg-spec><arg><named-E><N><n>KIDIA</n></N></named-E></arg>, <arg><named-E><N><n>KFDIA</n></N></named-E></arg>, <arg><named-E><N><n>KLON</n></N></named-E></arg>, <arg><named-E><N><n>KTDIA</n></N></named-E></arg>, <arg><named-E><N><n>KLEV</n></N></named-E></arg>, <arg><named-E><N><n>PDELP</n></N></named-E></arg>, <arg><named-E><N><n>ZQRC</n></N></named-E></arg>, <arg><named-E><N><n>PRR</n></N></named-E></arg>, <arg><named-E><N><n>PUDAL</n></N></named-E></arg>, <arg><named-E><N><n>PDDAL</n></N></named-E></arg>, <cnt>&amp;</cnt>
  <cnt>&amp;</cnt> <arg><named-E><N><n>ZENTR_U</n></N></named-E></arg>, <arg><named-E><N><n>ZENTR_D</n></N></named-E></arg>, <arg><named-E><N><n>ZDETR_U_RS</n></N></named-E></arg>, <arg><named-E><N><n>ZDETR_D_RS</n></N></named-E></arg>, <arg><named-E><N><n>PFEDQRC</n></N></named-E></arg></arg-spec>)</call-stmt>
<call-stmt>CALL <procedure-designator><named-E><N><n>ACMTENTR</n></N></named-E></procedure-designator>(<arg-spec><arg><named-E><N><n>KIDIA</n></N></named-E></arg>, <arg><named-E><N><n>KFDIA</n></N></named-E></arg>, <arg><named-E><N><n>KLON</n></N></named-E></arg>, <arg><named-E><N><n>KTDIA</n></N></named-E></arg>, <arg><named-E><N><n>KLEV</n></N></named-E></arg>, <arg><named-E><N><n>PDELP</n></N></named-E></arg>, <arg><named-E><N><n>ZQSC</n></N></named-E></arg>, <arg><named-E><N><n>PS</n></N></named-E></arg>,  <arg><named-E><N><n>PUDAL</n></N></named-E></arg>, <arg><named-E><N><n>PDDAL</n></N></named-E></arg>, <cnt>&amp;</cnt>
  <cnt>&amp;</cnt> <arg><named-E><N><n>ZENTR_U</n></N></named-E></arg>, <arg><named-E><N><n>ZENTR_D</n></N></named-E></arg>, <arg><named-E><N><n>ZDETR_U_RS</n></N></named-E></arg>, <arg><named-E><N><n>ZDETR_D_RS</n></N></named-E></arg>, <arg><named-E><N><n>PFEDQSC</n></N></named-E></arg></arg-spec>)</call-stmt>

<do-stmt>DO <do-V><named-E><N><n>JLEV</n></N></named-E></do-V> = <lower-bound><named-E><N><n>KTDIA</n></N></named-E></lower-bound>, <upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></do-stmt>
  <do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V> = <lower-bound><named-E><N><n>KIDIA</n></N></named-E></lower-bound>, <upper-bound><named-E><N><n>KFDIA</n></N></named-E></upper-bound></do-stmt>
    <C>! UPDATE INTRA-TIME-STEP VALUES FROM ENTRAINMENT/DETRAINMENT FLUXES.</C>
    <a-stmt><E-1><named-E><N><n>ZQLC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><named-E><N><n>MAX</n></N><R-LT><parens-R>(<element-LT><element><literal-E><l>0.</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></element>,<element><op-E><named-E><N><n>ZQLC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>-</o></op><op-E><named-E><N><n>RG</n></N></named-E><op><o>*</o></op><op-E><parens-E>(<cnt>&amp;</cnt>
      <cnt>&amp;</cnt><op-E><op-E><op><o>+</o></op><named-E><N><n>PFEDQLC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E><op><o>-</o></op><named-E><N><n>PFEDQLC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><op-E><named-E><N><n>JLEV</n></N></named-E><op><o>-</o></op><literal-E><l>1</l></literal-E></op-E></element></element-LT>)</parens-R></R-LT></named-E></op-E> <cnt>&amp;</cnt>
      <cnt>&amp;</cnt>)</parens-E><op><o>*</o></op><op-E><named-E><N><n>PRDELP</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>YRPHY2</n></N><R-LT><component-R>%<ct>TSPHY</ct></component-R></R-LT></named-E></op-E></op-E></op-E></op-E></element></element-LT>)</parens-R></R-LT></named-E></E-2></a-stmt>
    <a-stmt><E-1><named-E><N><n>ZQIC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><named-E><N><n>MAX</n></N><R-LT><parens-R>(<element-LT><element><literal-E><l>0.</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></element>,<element><op-E><named-E><N><n>ZQIC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>-</o></op><op-E><named-E><N><n>RG</n></N></named-E><op><o>*</o></op><op-E><parens-E>(<cnt>&amp;</cnt>
      <cnt>&amp;</cnt><op-E><op-E><op><o>+</o></op><named-E><N><n>PFEDQIC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E><op><o>-</o></op><named-E><N><n>PFEDQIC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><op-E><named-E><N><n>JLEV</n></N></named-E><op><o>-</o></op><literal-E><l>1</l></literal-E></op-E></element></element-LT>)</parens-R></R-LT></named-E></op-E> <cnt>&amp;</cnt>
      <cnt>&amp;</cnt>)</parens-E><op><o>*</o></op><op-E><named-E><N><n>PRDELP</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>YRPHY2</n></N><R-LT><component-R>%<ct>TSPHY</ct></component-R></R-LT></named-E></op-E></op-E></op-E></op-E></element></element-LT>)</parens-R></R-LT></named-E></E-2></a-stmt>
    <a-stmt><E-1><named-E><N><n>ZQRC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><named-E><N><n>MAX</n></N><R-LT><parens-R>(<element-LT><element><literal-E><l>0.</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></element>,<element><op-E><named-E><N><n>ZQRC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>-</o></op><op-E><named-E><N><n>RG</n></N></named-E><op><o>*</o></op><op-E><parens-E>(<cnt>&amp;</cnt>
      <cnt>&amp;</cnt><op-E><op-E><op><o>+</o></op><named-E><N><n>PFEDQRC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E><op><o>-</o></op><named-E><N><n>PFEDQRC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><op-E><named-E><N><n>JLEV</n></N></named-E><op><o>-</o></op><literal-E><l>1</l></literal-E></op-E></element></element-LT>)</parens-R></R-LT></named-E></op-E> <cnt>&amp;</cnt>
      <cnt>&amp;</cnt>)</parens-E><op><o>*</o></op><op-E><named-E><N><n>PRDELP</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>YRPHY2</n></N><R-LT><component-R>%<ct>TSPHY</ct></component-R></R-LT></named-E></op-E></op-E></op-E></op-E></element></element-LT>)</parens-R></R-LT></named-E></E-2></a-stmt>
    <a-stmt><E-1><named-E><N><n>ZQSC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><named-E><N><n>MAX</n></N><R-LT><parens-R>(<element-LT><element><literal-E><l>0.</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></element>,<element><op-E><named-E><N><n>ZQSC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>-</o></op><op-E><named-E><N><n>RG</n></N></named-E><op><o>*</o></op><op-E><parens-E>(<cnt>&amp;</cnt>
      <cnt>&amp;</cnt><op-E><op-E><op><o>+</o></op><named-E><N><n>PFEDQSC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E><op><o>-</o></op><named-E><N><n>PFEDQSC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><op-E><named-E><N><n>JLEV</n></N></named-E><op><o>-</o></op><literal-E><l>1</l></literal-E></op-E></element></element-LT>)</parens-R></R-LT></named-E></op-E> <cnt>&amp;</cnt>
      <cnt>&amp;</cnt>)</parens-E><op><o>*</o></op><op-E><named-E><N><n>PRDELP</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>YRPHY2</n></N><R-LT><component-R>%<ct>TSPHY</ct></component-R></R-LT></named-E></op-E></op-E></op-E></op-E></element></element-LT>)</parens-R></R-LT></named-E></E-2></a-stmt>
    <C>! DIAGNOSE CONDENSATE DETRAINED BY PCMT CONVECTION.</C>
    <a-stmt><E-1><named-E><N><n>PQC_DET_PCMT</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><named-E><N><n>MAX</n></N><R-LT><parens-R>(<element-LT><element><literal-E><l>0.</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></element>,<element><op-E><named-E><N><n>RG</n></N></named-E><op><o>*</o></op><op-E><parens-E>(<cnt>&amp;</cnt>
      <cnt>&amp;</cnt><op-E><op-E><op><o>+</o></op><named-E><N><n>PFEDQLC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E><op><o>-</o></op><op-E><named-E><N><n>PFEDQLC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><op-E><named-E><N><n>JLEV</n></N></named-E><op><o>-</o></op><literal-E><l>1</l></literal-E></op-E></element></element-LT>)</parens-R></R-LT></named-E> <cnt>&amp;</cnt>
      <cnt>&amp;</cnt><op><o>+</o></op><op-E><named-E><N><n>PFEDQIC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>-</o></op><named-E><N><n>PFEDQIC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><op-E><named-E><N><n>JLEV</n></N></named-E><op><o>-</o></op><literal-E><l>1</l></literal-E></op-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></op-E></op-E> <cnt>&amp;</cnt>
      <cnt>&amp;</cnt>)</parens-E><op><o>*</o></op><op-E><named-E><N><n>PRDELP</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>YRPHY2</n></N><R-LT><component-R>%<ct>TSPHY</ct></component-R></R-LT></named-E></op-E></op-E></op-E></element></element-LT>)</parens-R></R-LT></named-E></E-2></a-stmt>
  <end-do-stmt>ENDDO</end-do-stmt>
<end-do-stmt>ENDDO</end-do-stmt>

<do-stmt>DO <do-V><named-E><N><n>JLEV</n></N></named-E></do-V> = <lower-bound><literal-E><l>1</l></literal-E></lower-bound>, <upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></do-stmt>
<do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V> = <lower-bound><literal-E><l>1</l></literal-E></lower-bound>, <upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></do-stmt>
<a-stmt><E-1><named-E><N><n>ZQLCED</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a> <E-2><named-E><N><n>ZQLC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-2></a-stmt>
<end-do-stmt>ENDDO</end-do-stmt>
<end-do-stmt>ENDDO</end-do-stmt>

<do-stmt>DO <do-V><named-E><N><n>JLEV</n></N></named-E></do-V> = <lower-bound><literal-E><l>1</l></literal-E></lower-bound>, <upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></do-stmt>
<do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V> = <lower-bound><literal-E><l>1</l></literal-E></lower-bound>, <upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></do-stmt>
<a-stmt><E-1><named-E><N><n>ZQICED</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a> <E-2><named-E><N><n>ZQIC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-2></a-stmt>
<end-do-stmt>ENDDO</end-do-stmt>
<end-do-stmt>ENDDO</end-do-stmt>

<C>! UPDATE INTRA-TIME-STEP CONVECTIVE VALUES FROM CONDENSATION FLUXES.</C>
<do-stmt>DO <do-V><named-E><N><n>JLEV</n></N></named-E></do-V> = <lower-bound><named-E><N><n>KTDIA</n></N></named-E></lower-bound>, <upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></do-stmt>
  <do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V> = <lower-bound><named-E><N><n>KIDIA</n></N></named-E></lower-bound>, <upper-bound><named-E><N><n>KFDIA</n></N></named-E></upper-bound></do-stmt>
    <a-stmt><E-1><named-E><N><n>ZQLC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>ZQLC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>-</o></op><op-E><named-E><N><n>RG</n></N></named-E><op><o>*</o></op><op-E><parens-E>(<cnt>&amp;</cnt>
      <cnt>&amp;</cnt><op-E><op-E><op><o>-</o></op><named-E><N><n>PFCCQL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E><op><o>+</o></op><named-E><N><n>PFCCQL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><op-E><named-E><N><n>JLEV</n></N></named-E><op><o>-</o></op><literal-E><l>1</l></literal-E></op-E></element></element-LT>)</parens-R></R-LT></named-E></op-E> <cnt>&amp;</cnt>
      <cnt>&amp;</cnt>)</parens-E><op><o>*</o></op><op-E><named-E><N><n>PRDELP</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>YRPHY2</n></N><R-LT><component-R>%<ct>TSPHY</ct></component-R></R-LT></named-E></op-E></op-E></op-E></op-E></E-2></a-stmt>
    <a-stmt><E-1><named-E><N><n>ZQIC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>ZQIC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>-</o></op><op-E><named-E><N><n>RG</n></N></named-E><op><o>*</o></op><op-E><parens-E>(<cnt>&amp;</cnt>
      <cnt>&amp;</cnt><op-E><op-E><op><o>-</o></op><named-E><N><n>PFCCQN</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E><op><o>+</o></op><named-E><N><n>PFCCQN</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><op-E><named-E><N><n>JLEV</n></N></named-E><op><o>-</o></op><literal-E><l>1</l></literal-E></op-E></element></element-LT>)</parens-R></R-LT></named-E></op-E> <cnt>&amp;</cnt>
      <cnt>&amp;</cnt>)</parens-E><op><o>*</o></op><op-E><named-E><N><n>PRDELP</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>YRPHY2</n></N><R-LT><component-R>%<ct>TSPHY</ct></component-R></R-LT></named-E></op-E></op-E></op-E></op-E></E-2></a-stmt>
  <end-do-stmt>ENDDO</end-do-stmt>
<end-do-stmt>ENDDO</end-do-stmt>

<C>!-------------------------------------------------</C>
<C>! &quot;LOPEZ&quot; MICROPHYSICS: AUTOCONVERSION / COLLECTION / SEDIMENTATION OF PRECIPITATION / EVAPORATION OF PRECIPITATION.</C>
<C>!-------------------------------------------------</C>

<C>! QCCONV = QLCONV + QICONV.</C>
<do-stmt>DO <do-V><named-E><N><n>JLEV</n></N></named-E></do-V> = <lower-bound><named-E><N><n>KTDIA</n></N></named-E></lower-bound>, <upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></do-stmt>
  <do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V> = <lower-bound><named-E><N><n>KIDIA</n></N></named-E></lower-bound>, <upper-bound><named-E><N><n>KFDIA</n></N></named-E></upper-bound></do-stmt>
    <a-stmt><E-1><named-E><N><n>ZQLIC_MICRO</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>ZQLC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>+</o></op><named-E><N><n>ZQIC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></E-2></a-stmt>
    <a-stmt><E-1><named-E><N><n>ZQ_COND_XR96</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>ZQLC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>+</o></op><op-E><named-E><N><n>ZQIC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E> <cnt>&amp;</cnt>
     <cnt>&amp;</cnt> <op><o>+</o></op><op-E><named-E><N><n>ZQRC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>+</o></op><named-E><N><n>ZQSC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></op-E></op-E></E-2></a-stmt>
  <end-do-stmt>ENDDO</end-do-stmt>
<end-do-stmt>ENDDO</end-do-stmt>
<do-stmt>DO <do-V><named-E><N><n>JLEV</n></N></named-E></do-V> = <lower-bound><literal-E><l>0</l></literal-E></lower-bound>, <upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></do-stmt>
<do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V> = <lower-bound><literal-E><l>1</l></literal-E></lower-bound>, <upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></do-stmt>
<a-stmt><E-1><named-E><N><n>ZFCCQLTMP</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a> <E-2><literal-E><l>0.</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></E-2></a-stmt>
<end-do-stmt>ENDDO</end-do-stmt>
<end-do-stmt>ENDDO</end-do-stmt>

<do-stmt>DO <do-V><named-E><N><n>JLEV</n></N></named-E></do-V> = <lower-bound><literal-E><l>0</l></literal-E></lower-bound>, <upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></do-stmt>
<do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V> = <lower-bound><literal-E><l>1</l></literal-E></lower-bound>, <upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></do-stmt>
<a-stmt><E-1><named-E><N><n>ZFCCQNTMP</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a> <E-2><literal-E><l>0.</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></E-2></a-stmt>
<end-do-stmt>ENDDO</end-do-stmt>
<end-do-stmt>ENDDO</end-do-stmt>

<if-then-stmt>IF(<condition-E><named-E><N><n>YRPHY</n></N><R-LT><component-R>%<ct>LNEBNXR</ct></component-R></R-LT></named-E></condition-E>) THEN</if-then-stmt>
  <C>! XU-RANDALL 1996 CLOUDINESS.</C>
  <call-stmt>CALL <procedure-designator><named-E><N><n>ACNEBXRS</n></N></named-E></procedure-designator> ( <arg-spec><arg><named-E><N><n>KIDIA</n></N></named-E></arg>,<arg><named-E><N><n>KFDIA</n></N></named-E></arg>,<arg><named-E><N><n>KLON</n></N></named-E></arg>,<arg><named-E><N><n>KTDIA</n></N></named-E></arg>,<arg><named-E><N><n>KLEV</n></N></named-E></arg>,<cnt>&amp;</cnt>
    <cnt>&amp;</cnt> <arg><named-E><N><n>PQ</n></N></named-E></arg>,<arg><named-E><N><n>ZQ_COND_XR96</n></N></named-E></arg>,<arg><named-E><N><n>PQSAT</n></N></named-E></arg>,<cnt>&amp;</cnt>
    <cnt>&amp;</cnt> <arg><named-E><N><n>ZNEBC_MICRO</n></N></named-E></arg></arg-spec>)</call-stmt>
  <do-stmt>DO <do-V><named-E><N><n>JLEV</n></N></named-E></do-V> = <lower-bound><named-E><N><n>KTDIA</n></N></named-E></lower-bound>, <upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></do-stmt>
    <do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V> = <lower-bound><named-E><N><n>KIDIA</n></N></named-E></lower-bound>, <upper-bound><named-E><N><n>KFDIA</n></N></named-E></upper-bound></do-stmt>
      <a-stmt><E-1><named-E><N><n>PQLIC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><named-E><N><n>ZQ_COND_XR96</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-2></a-stmt>
      <a-stmt><E-1><named-E><N><n>PNEBC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>ZNEBC_MICRO</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>YRPHY0</n></N><R-LT><component-R>%<ct>FNEBC</ct></component-R></R-LT></named-E></op-E></E-2></a-stmt>
    <end-do-stmt>ENDDO</end-do-stmt>
  <end-do-stmt>ENDDO</end-do-stmt>
<else-stmt>ELSE</else-stmt>
  <if-then-stmt>IF(<condition-E><named-E><N><n>YRPHY0</n></N><R-LT><component-R>%<ct>LCVMICC</ct></component-R></R-LT></named-E></condition-E>) THEN</if-then-stmt>
    <do-stmt>DO <do-V><named-E><N><n>JLEV</n></N></named-E></do-V> = <lower-bound><named-E><N><n>KTDIA</n></N></named-E></lower-bound>, <upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></do-stmt>
      <do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V> = <lower-bound><named-E><N><n>KIDIA</n></N></named-E></lower-bound>, <upper-bound><named-E><N><n>KFDIA</n></N></named-E></upper-bound></do-stmt>
        <a-stmt><E-1><named-E><N><n>ZDAL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><named-E><N><n>MAX</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>ZDAL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></element>,<element><op-E><named-E><N><n>PUDAL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>+</o></op><named-E><N><n>PDDAL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></element></element-LT>)</parens-R></R-LT></named-E></E-2></a-stmt>
      <end-do-stmt>ENDDO</end-do-stmt>
    <end-do-stmt>ENDDO</end-do-stmt>
  <end-if-stmt>ENDIF</end-if-stmt>
  <do-stmt>DO <do-V><named-E><N><n>JLEV</n></N></named-E></do-V> = <lower-bound><named-E><N><n>KTDIA</n></N></named-E></lower-bound>, <upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></do-stmt>
    <do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V> = <lower-bound><named-E><N><n>KIDIA</n></N></named-E></lower-bound>, <upper-bound><named-E><N><n>KFDIA</n></N></named-E></upper-bound></do-stmt>
      <C>! CONSISTENCY BETWEEN CLOUDINESS AND CLOUD CONDENSATE:</C>
      <C>! ZNEBC_MICRO=PUDAL+PDDAL WHERE &gt;0, ZQLIC_MICRO/3.E-3 OTHERWISE</C>
      <a-stmt><E-1><named-E><N><n>IQLIC_MICRO</n></N></named-E></E-1><a>=</a><E-2><named-E><N><n>NINT</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>MAX</n></N><R-LT><parens-R>(<element-LT><element><literal-E><l>0.0</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></element>,<element><op-E><op><o>-</o></op><named-E><N><n>SIGN</n></N><R-LT><parens-R>(<element-LT><element><literal-E><l>1.0</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></element>,<element><op-E><op-E><op><o>-</o></op><named-E><N><n>ZQLIC_MICRO</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E><op><o>+</o></op><literal-E><l>0.0</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></op-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></element></element-LT>)</parens-R></R-LT></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-2></a-stmt>
      <a-stmt><E-1><named-E><N><n>IQLIC</n></N></named-E></E-1><a>=</a><E-2><named-E><N><n>NINT</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>MAX</n></N><R-LT><parens-R>(<element-LT><element><literal-E><l>0.0</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></element>,<element><op-E><op><o>-</o></op><named-E><N><n>SIGN</n></N><R-LT><parens-R>(<element-LT><element><literal-E><l>1.0</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></element>,<element><op-E><op-E><op><o>-</o></op><named-E><N><n>PQLIC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E><op><o>+</o></op><literal-E><l>0.0</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></op-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></element></element-LT>)</parens-R></R-LT></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-2></a-stmt>
      <a-stmt><E-1><named-E><N><n>INEBC</n></N></named-E></E-1><a>=</a><E-2><named-E><N><n>NINT</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>MAX</n></N><R-LT><parens-R>(<element-LT><element><literal-E><l>0.0</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></element>,<element><op-E><op><o>-</o></op><named-E><N><n>SIGN</n></N><R-LT><parens-R>(<element-LT><element><literal-E><l>1.0</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></element>,<element><op-E><op-E><op><o>-</o></op><parens-E>(<op-E><named-E><N><n>PUDAL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>IQLIC</n></N></named-E></op-E>)</parens-E></op-E><op><o>+</o></op><literal-E><l>0.0</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></op-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></element></element-LT>)</parens-R></R-LT></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-2></a-stmt>
      <if-then-stmt>IF(<condition-E><named-E><N><n>YRPHY0</n></N><R-LT><component-R>%<ct>LCVMICC</ct></component-R></R-LT></named-E></condition-E>) THEN</if-then-stmt>
        <a-stmt><E-1><named-E><N><n>ZNEBC_MICRO</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><op-E><parens-E>(<op-E><literal-E><l>1</l></literal-E><op><o>-</o></op><named-E><N><n>IQLIC_MICRO</n></N></named-E></op-E>)</parens-E><op><o>*</o></op><named-E><N><n>ZEPS</n></N></named-E></op-E> <cnt>&amp;</cnt>
         <cnt>&amp;</cnt><op><o>+</o></op><op-E><named-E><N><n>IQLIC_MICRO</n></N></named-E><op><o>*</o></op><parens-E>(<op-E><op-E><named-E><N><n>INEBC</n></N></named-E><op><o>*</o></op><named-E><N><n>MAX</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>ZEPS</n></N></named-E></element>,<element><parens-E>(<op-E><named-E><N><n>PUDAL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>+</o></op><named-E><N><n>PDDAL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E>)</parens-E></element></element-LT>)</parens-R></R-LT></named-E></op-E> <cnt>&amp;</cnt>
         <cnt>&amp;</cnt><op><o>+</o></op><op-E><parens-E>(<op-E><literal-E><l>1</l></literal-E><op><o>-</o></op><named-E><N><n>INEBC</n></N></named-E></op-E>)</parens-E><op><o>*</o></op><named-E><N><n>MAX</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>ZEPS</n></N></named-E></element>,<element><named-E><N><n>MIN</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>ZDAL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></element>,<element><op-E><named-E><N><n>ZQLIC_MICRO</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>/</o></op><literal-E><l>1.E-2</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></op-E></element></element-LT>)</parens-R></R-LT></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></op-E>)</parens-E></op-E></op-E></E-2></a-stmt>
      <else-stmt>ELSE</else-stmt>
        <a-stmt><E-1><named-E><N><n>ZNEBC_MICRO</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><op-E><parens-E>(<op-E><literal-E><l>1</l></literal-E><op><o>-</o></op><named-E><N><n>IQLIC_MICRO</n></N></named-E></op-E>)</parens-E><op><o>*</o></op><named-E><N><n>ZEPS</n></N></named-E></op-E> <cnt>&amp;</cnt>
         <cnt>&amp;</cnt><op><o>+</o></op><op-E><named-E><N><n>IQLIC_MICRO</n></N></named-E><op><o>*</o></op><parens-E>(<op-E><op-E><named-E><N><n>INEBC</n></N></named-E><op><o>*</o></op><named-E><N><n>MAX</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>ZEPS</n></N></named-E></element>,<element><parens-E>(<op-E><named-E><N><n>PUDAL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>+</o></op><named-E><N><n>PDDAL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E>)</parens-E></element></element-LT>)</parens-R></R-LT></named-E></op-E> <cnt>&amp;</cnt>
         <cnt>&amp;</cnt><op><o>+</o></op><op-E><parens-E>(<op-E><literal-E><l>1</l></literal-E><op><o>-</o></op><named-E><N><n>INEBC</n></N></named-E></op-E>)</parens-E><op><o>*</o></op><named-E><N><n>MAX</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>ZEPS</n></N></named-E></element>,<element><named-E><N><n>MIN</n></N><R-LT><parens-R>(<element-LT><element><literal-E><l>0.9999</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></element>,<element><op-E><named-E><N><n>ZQLIC_MICRO</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>/</o></op><literal-E><l>3.E-3</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></op-E></element></element-LT>)</parens-R></R-LT></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></op-E>)</parens-E></op-E></op-E></E-2></a-stmt>
      <end-if-stmt>ENDIF</end-if-stmt>
    <end-do-stmt>ENDDO</end-do-stmt>
  <end-do-stmt>ENDDO</end-do-stmt>
<end-if-stmt>ENDIF</end-if-stmt>
<do-stmt>DO <do-V><named-E><N><n>JLEV</n></N></named-E></do-V> = <lower-bound><literal-E><l>1</l></literal-E></lower-bound>, <upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></do-stmt>
<do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V> = <lower-bound><literal-E><l>1</l></literal-E></lower-bound>, <upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></do-stmt>
<a-stmt><E-1><named-E><N><n>ZEROV</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a> <E-2><literal-E><l>0.</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></E-2></a-stmt>
<end-do-stmt>ENDDO</end-do-stmt>
<end-do-stmt>ENDDO</end-do-stmt>

<do-stmt>DO <do-V><named-E><N><n>JLEV</n></N></named-E></do-V> = <lower-bound><literal-E><l>0</l></literal-E></lower-bound>, <upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></do-stmt>
<do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V> = <lower-bound><literal-E><l>1</l></literal-E></lower-bound>, <upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></do-stmt>
<a-stmt><E-1><named-E><N><n>PFCCQL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a> <E-2><literal-E><l>0.</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></E-2></a-stmt>
<end-do-stmt>ENDDO</end-do-stmt>
<end-do-stmt>ENDDO</end-do-stmt>

<do-stmt>DO <do-V><named-E><N><n>JLEV</n></N></named-E></do-V> = <lower-bound><literal-E><l>0</l></literal-E></lower-bound>, <upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></do-stmt>
<do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V> = <lower-bound><literal-E><l>1</l></literal-E></lower-bound>, <upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></do-stmt>
<a-stmt><E-1><named-E><N><n>PFCCQN</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a> <E-2><literal-E><l>0.</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></E-2></a-stmt>
<end-do-stmt>ENDDO</end-do-stmt>
<end-do-stmt>ENDDO</end-do-stmt>


<C>! Microphysics occurs in a shell between updraft and its resolved environment.</C>
<do-stmt>DO <do-V><named-E><N><n>JLEV</n></N></named-E></do-V> = <lower-bound><named-E><N><n>KTDIA</n></N></named-E></lower-bound>, <upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></do-stmt>
<do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V> = <lower-bound><named-E><N><n>KIDIA</n></N></named-E></lower-bound>, <upper-bound><named-E><N><n>KFDIA</n></N></named-E></upper-bound></do-stmt>
<a-stmt><E-1><named-E><N><n>ZTMIC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><op-E><parens-E>(<op-E><literal-E><l>1.</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E><op><o>-</o></op><named-E><N><n>YRPHY0</n></N><R-LT><component-R>%<ct>GSHELL</ct></component-R></R-LT></named-E></op-E>)</parens-E><op><o>*</o></op><named-E><N><n>PTU</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E> <cnt>&amp;</cnt>
  <cnt>&amp;</cnt> <op><o>+</o></op><op-E><named-E><N><n>YRPHY0</n></N><R-LT><component-R>%<ct>GSHELL</ct></component-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>PT</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></op-E></E-2></a-stmt>
<end-do-stmt>ENDDO</end-do-stmt>
<end-do-stmt>ENDDO</end-do-stmt>
<do-stmt>DO <do-V><named-E><N><n>JLEV</n></N></named-E></do-V> = <lower-bound><named-E><N><n>KTDIA</n></N></named-E></lower-bound>, <upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></do-stmt>
<do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V> = <lower-bound><named-E><N><n>KIDIA</n></N></named-E></lower-bound>, <upper-bound><named-E><N><n>KFDIA</n></N></named-E></upper-bound></do-stmt>
<a-stmt><E-1><named-E><N><n>ZQMIC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><op-E><parens-E>(<op-E><literal-E><l>1.</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E><op><o>-</o></op><named-E><N><n>YRPHY0</n></N><R-LT><component-R>%<ct>GSHELL</ct></component-R></R-LT></named-E></op-E>)</parens-E><op><o>*</o></op><named-E><N><n>PQU</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E> <cnt>&amp;</cnt>
  <cnt>&amp;</cnt> <op><o>+</o></op><op-E><named-E><N><n>YRPHY0</n></N><R-LT><component-R>%<ct>GSHELL</ct></component-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>PQ</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></op-E></E-2></a-stmt>
<end-do-stmt>ENDDO</end-do-stmt>
<end-do-stmt>ENDDO</end-do-stmt>

<C>! Call microphysics.</C>
<a-stmt><E-1><named-E><N><n>LLADJCLD</n></N></named-E></E-1><a>=</a><E-2><literal-E>.FALSE.</literal-E></E-2></a-stmt>
<call-stmt>CALL <procedure-designator><named-E><N><n>ACPLUIZ</n></N></named-E></procedure-designator> ( <arg-spec><arg><named-E><N><n>KIDIA</n></N></named-E></arg>,<arg><named-E><N><n>KFDIA</n></N></named-E></arg>,<arg><named-E><N><n>KLON</n></N></named-E></arg>,<arg><named-E><N><n>KTDIA</n></N></named-E></arg>,<arg><named-E><N><n>KLEV</n></N></named-E></arg>,<cnt>&amp;</cnt>
  <cnt>&amp;</cnt> <arg><named-E><N><n>ZTMIC</n></N></named-E></arg>, <arg><named-E><N><n>ZQMIC</n></N></named-E></arg>, <arg><named-E><N><n>ZQLCED</n></N></named-E></arg>, <arg><named-E><N><n>ZQICED</n></N></named-E></arg>, <arg><named-E><N><n>ZQRC</n></N></named-E></arg>, <arg><named-E><N><n>ZQSC</n></N></named-E></arg>,<cnt>&amp;</cnt>
  <cnt>&amp;</cnt> <arg><named-E><N><n>PDELP</n></N></named-E></arg>, <arg><named-E><N><n>PAPRSF</n></N></named-E></arg>, <arg><named-E><N><n>PCP</n></N></named-E></arg>, <arg><named-E><N><n>PR</n></N></named-E></arg>, <arg><named-E><N><n>ZNEBC_MICRO</n></N></named-E></arg>, <arg><named-E><N><n>ZQLIC_MICRO</n></N></named-E></arg>,<arg><named-E><N><n>ZEROV</n></N></named-E></arg>,<arg><named-E><N><n>ZEROV</n></N></named-E></arg>,<arg><named-E><N><n>ZEROV</n></N></named-E></arg>,<cnt>&amp;</cnt>
  <cnt>&amp;</cnt> <arg><named-E><N><n>ZEROV</n></N></named-E></arg>, <arg><named-E><N><n>ZEROV</n></N></named-E></arg>, <arg><named-E><N><n>LLADJCLD</n></N></named-E></arg>, <arg><named-E><N><n>PAPHI</n></N></named-E></arg>,<cnt>&amp;</cnt>
  <cnt>&amp;</cnt> <arg><named-E><N><n>PTS</n></N></named-E></arg>, <arg><named-E><N><n>PNEIJ</n></N></named-E></arg>, <arg><named-E><N><n>PLSM</n></N></named-E></arg>, <arg><named-E><N><n>PGM</n></N></named-E></arg>, <arg><named-E><N><n>PVETAF</n></N></named-E></arg>, <cnt>&amp;</cnt>
  <cnt>&amp;</cnt> <arg><named-E><N><n>PFCCQL</n></N></named-E></arg>,<arg><named-E><N><n>PFCCQN</n></N></named-E></arg>, <arg><named-E><N><n>PFPLCL</n></N></named-E></arg>, <arg><named-E><N><n>PFPLCN</n></N></named-E></arg>,<cnt>&amp;</cnt>
  <cnt>&amp;</cnt> <arg><named-E><N><n>PFPEVPCL</n></N></named-E></arg>, <arg><named-E><N><n>PFPEVPCN</n></N></named-E></arg>, <arg><named-E><N><n>PFPFPCL</n></N></named-E></arg>, <arg><named-E><N><n>PFPFPCN</n></N></named-E></arg>, <arg><named-E><N><n>PDIFCQLC</n></N></named-E></arg>, <arg><named-E><N><n>PDIFCQIC</n></N></named-E></arg></arg-spec> )</call-stmt>

<C>! UPDATE INTRA-TIME-STEP CONVECTIVE VALUES FROM MICROPHYSICAL FLUXES.</C>
<do-stmt>DO <do-V><named-E><N><n>JLEV</n></N></named-E></do-V> = <lower-bound><named-E><N><n>KTDIA</n></N></named-E></lower-bound>, <upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></do-stmt>
  <do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V> = <lower-bound><named-E><N><n>KIDIA</n></N></named-E></lower-bound>, <upper-bound><named-E><N><n>KFDIA</n></N></named-E></upper-bound></do-stmt>
    <a-stmt><E-1><named-E><N><n>ZQLC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>ZQLC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>-</o></op><op-E><named-E><N><n>RG</n></N></named-E><op><o>*</o></op><op-E><parens-E>(<cnt>&amp;</cnt>
      <cnt>&amp;</cnt><op-E><op-E><op><o>+</o></op><named-E><N><n>PFPFPCL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E><op><o>-</o></op><named-E><N><n>PFPFPCL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><op-E><named-E><N><n>JLEV</n></N></named-E><op><o>-</o></op><literal-E><l>1</l></literal-E></op-E></element></element-LT>)</parens-R></R-LT></named-E></op-E> <cnt>&amp;</cnt>
      <cnt>&amp;</cnt>)</parens-E><op><o>*</o></op><op-E><named-E><N><n>PRDELP</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>YRPHY2</n></N><R-LT><component-R>%<ct>TSPHY</ct></component-R></R-LT></named-E></op-E></op-E></op-E></op-E></E-2></a-stmt>
    <a-stmt><E-1><named-E><N><n>ZQIC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>ZQIC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>-</o></op><op-E><named-E><N><n>RG</n></N></named-E><op><o>*</o></op><op-E><parens-E>(<cnt>&amp;</cnt>
      <cnt>&amp;</cnt><op-E><op-E><op><o>+</o></op><named-E><N><n>PFPFPCN</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E><op><o>-</o></op><named-E><N><n>PFPFPCN</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><op-E><named-E><N><n>JLEV</n></N></named-E><op><o>-</o></op><literal-E><l>1</l></literal-E></op-E></element></element-LT>)</parens-R></R-LT></named-E></op-E> <cnt>&amp;</cnt>
      <cnt>&amp;</cnt>)</parens-E><op><o>*</o></op><op-E><named-E><N><n>PRDELP</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>YRPHY2</n></N><R-LT><component-R>%<ct>TSPHY</ct></component-R></R-LT></named-E></op-E></op-E></op-E></op-E></E-2></a-stmt>
    <a-stmt><E-1><named-E><N><n>ZQRC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>ZQRC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>-</o></op><op-E><named-E><N><n>RG</n></N></named-E><op><o>*</o></op><op-E><parens-E>(<cnt>&amp;</cnt>
      <cnt>&amp;</cnt><op-E><op-E><op><o>+</o></op><named-E><N><n>PFPLCL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E><op><o>-</o></op><op-E><named-E><N><n>PFPLCL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><op-E><named-E><N><n>JLEV</n></N></named-E><op><o>-</o></op><literal-E><l>1</l></literal-E></op-E></element></element-LT>)</parens-R></R-LT></named-E> <cnt>&amp;</cnt>
      <cnt>&amp;</cnt><op><o>-</o></op><op-E><named-E><N><n>PFPFPCL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>+</o></op><op-E><named-E><N><n>PFPFPCL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><op-E><named-E><N><n>JLEV</n></N></named-E><op><o>-</o></op><literal-E><l>1</l></literal-E></op-E></element></element-LT>)</parens-R></R-LT></named-E> <cnt>&amp;</cnt>
      <cnt>&amp;</cnt><op><o>+</o></op><op-E><named-E><N><n>PFPEVPCL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>-</o></op><named-E><N><n>PFPEVPCL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><op-E><named-E><N><n>JLEV</n></N></named-E><op><o>-</o></op><literal-E><l>1</l></literal-E></op-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></op-E></op-E></op-E></op-E> <cnt>&amp;</cnt>
      <cnt>&amp;</cnt>)</parens-E><op><o>*</o></op><op-E><named-E><N><n>PRDELP</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>YRPHY2</n></N><R-LT><component-R>%<ct>TSPHY</ct></component-R></R-LT></named-E></op-E></op-E></op-E></op-E></E-2></a-stmt>
    <a-stmt><E-1><named-E><N><n>ZQSC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>ZQSC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>-</o></op><op-E><named-E><N><n>RG</n></N></named-E><op><o>*</o></op><op-E><parens-E>(<cnt>&amp;</cnt>
      <cnt>&amp;</cnt><op-E><op-E><op><o>+</o></op><named-E><N><n>PFPLCN</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E><op><o>-</o></op><op-E><named-E><N><n>PFPLCN</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><op-E><named-E><N><n>JLEV</n></N></named-E><op><o>-</o></op><literal-E><l>1</l></literal-E></op-E></element></element-LT>)</parens-R></R-LT></named-E> <cnt>&amp;</cnt>
      <cnt>&amp;</cnt><op><o>-</o></op><op-E><named-E><N><n>PFPFPCN</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>+</o></op><op-E><named-E><N><n>PFPFPCN</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><op-E><named-E><N><n>JLEV</n></N></named-E><op><o>-</o></op><literal-E><l>1</l></literal-E></op-E></element></element-LT>)</parens-R></R-LT></named-E> <cnt>&amp;</cnt>
      <cnt>&amp;</cnt><op><o>+</o></op><op-E><named-E><N><n>PFPEVPCN</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>-</o></op><named-E><N><n>PFPEVPCN</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><op-E><named-E><N><n>JLEV</n></N></named-E><op><o>-</o></op><literal-E><l>1</l></literal-E></op-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></op-E></op-E></op-E></op-E> <cnt>&amp;</cnt>
      <cnt>&amp;</cnt>)</parens-E><op><o>*</o></op><op-E><named-E><N><n>PRDELP</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>YRPHY2</n></N><R-LT><component-R>%<ct>TSPHY</ct></component-R></R-LT></named-E></op-E></op-E></op-E></op-E></E-2></a-stmt>
  <end-do-stmt>ENDDO</end-do-stmt>
<end-do-stmt>ENDDO</end-do-stmt>

<C>!-------------------------------------------------</C>
<C>! VERTICAL TRANSPORT OF QLCONV AND QICONV.</C>
<C>!-------------------------------------------------</C>

<do-stmt>DO <do-V><named-E><N><n>JLEV</n></N></named-E></do-V> = <lower-bound><named-E><N><n>KTDIA</n></N></named-E></lower-bound>, <upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></do-stmt>
  <do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V> = <lower-bound><named-E><N><n>KIDIA</n></N></named-E></lower-bound>,<upper-bound><named-E><N><n>KFDIA</n></N></named-E></upper-bound></do-stmt>
    <a-stmt><E-1><named-E><N><n>ZUDW</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><op><o>-</o></op><op-E><named-E><N><n>PUDOM</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><op-E><named-E><N><n>PR</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><op-E><named-E><N><n>PT</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>/</o></op><parens-E>(<op-E><named-E><N><n>PAPRSF</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>RG</n></N></named-E></op-E>)</parens-E></op-E></op-E></op-E></op-E></E-2></a-stmt>
    <a-stmt><E-1><named-E><N><n>ZDDW</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><op><o>-</o></op><op-E><named-E><N><n>PDDOM</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><op-E><named-E><N><n>PR</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><op-E><named-E><N><n>PT</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>/</o></op><parens-E>(<op-E><named-E><N><n>PAPRSF</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>RG</n></N></named-E></op-E>)</parens-E></op-E></op-E></op-E></op-E></E-2></a-stmt>
    <a-stmt><E-1><named-E><N><n>ZW_COMPENS</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><op><o>-</o></op><op-E><parens-E>(<op-E><op-E><named-E><N><n>PUDAL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>ZUDW</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E><op><o>+</o></op><op-E><named-E><N><n>PDDAL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>ZDDW</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></op-E>)</parens-E> <cnt>&amp;</cnt>
      <cnt>&amp;</cnt><op><o>/</o></op><named-E><N><n>MAX</n></N><R-LT><parens-R>(<element-LT><element><literal-E><l>1.E-4</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></element>,<element><op-E><literal-E><l>1.</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E><op><o>-</o></op><op-E><named-E><N><n>PUDAL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>-</o></op><named-E><N><n>PDDAL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></op-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></op-E></E-2></a-stmt>
    <a-stmt><E-1><named-E><N><n>ZW_CONV</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><parens-E>(<op-E><op-E><named-E><N><n>PUDAL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>ZUDW</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E><op><o>+</o></op><op-E><named-E><N><n>PDDAL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>ZDDW</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></op-E>)</parens-E> <cnt>&amp;</cnt>
      <cnt>&amp;</cnt><op><o>/</o></op><named-E><N><n>MAX</n></N><R-LT><parens-R>(<element-LT><element><literal-E><l>1.E-4</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></element>,<element><op-E><named-E><N><n>PUDAL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>+</o></op><named-E><N><n>PDDAL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></E-2></a-stmt>
  <end-do-stmt>ENDDO</end-do-stmt>
<end-do-stmt>ENDDO</end-do-stmt>

<C>! CONVECTIVE TRANSPORT OF CONVECTIVE CONDENSATES IN THE UPDRAFT.</C>
<call-stmt>CALL <procedure-designator><named-E><N><n>ACADVEC</n></N></named-E></procedure-designator> (<arg-spec><arg><named-E><N><n>KIDIA</n></N></named-E></arg>, <arg><named-E><N><n>KFDIA</n></N></named-E></arg>, <arg><named-E><N><n>KLON</n></N></named-E></arg>, <arg><named-E><N><n>KTDIA</n></N></named-E></arg>, <arg><named-E><N><n>KLEV</n></N></named-E></arg>, <arg><named-E><N><n>PDELP</n></N></named-E></arg>, <arg><named-E><N><n>PAPHI</n></N></named-E></arg>, <arg><named-E><N><n>ZQLC</n></N></named-E></arg>, <arg><named-E><N><n>ZW_CONV</n></N></named-E></arg>, <arg><named-E><N><n>PDIFCQLC</n></N></named-E></arg></arg-spec>)</call-stmt>
<call-stmt>CALL <procedure-designator><named-E><N><n>ACADVEC</n></N></named-E></procedure-designator> (<arg-spec><arg><named-E><N><n>KIDIA</n></N></named-E></arg>, <arg><named-E><N><n>KFDIA</n></N></named-E></arg>, <arg><named-E><N><n>KLON</n></N></named-E></arg>, <arg><named-E><N><n>KTDIA</n></N></named-E></arg>, <arg><named-E><N><n>KLEV</n></N></named-E></arg>, <arg><named-E><N><n>PDELP</n></N></named-E></arg>, <arg><named-E><N><n>PAPHI</n></N></named-E></arg>, <arg><named-E><N><n>ZQIC</n></N></named-E></arg>, <arg><named-E><N><n>ZW_CONV</n></N></named-E></arg>, <arg><named-E><N><n>PDIFCQIC</n></N></named-E></arg></arg-spec>)</call-stmt>

<C>! CONVECTIVE TRANSPORT OF RESOLVED CONDENSATES IN THE ENVIRONMENT.</C>
<call-stmt>CALL <procedure-designator><named-E><N><n>ACADVEC</n></N></named-E></procedure-designator> (<arg-spec><arg><named-E><N><n>KIDIA</n></N></named-E></arg>, <arg><named-E><N><n>KFDIA</n></N></named-E></arg>, <arg><named-E><N><n>KLON</n></N></named-E></arg>, <arg><named-E><N><n>KTDIA</n></N></named-E></arg>, <arg><named-E><N><n>KLEV</n></N></named-E></arg>, <arg><named-E><N><n>PDELP</n></N></named-E></arg>, <arg><named-E><N><n>PAPHI</n></N></named-E></arg>, <arg><named-E><N><n>PQL</n></N></named-E></arg>, <arg><named-E><N><n>ZW_COMPENS</n></N></named-E></arg>, <arg><named-E><N><n>PDIFCQL</n></N></named-E></arg></arg-spec>)</call-stmt>
<call-stmt>CALL <procedure-designator><named-E><N><n>ACADVEC</n></N></named-E></procedure-designator> (<arg-spec><arg><named-E><N><n>KIDIA</n></N></named-E></arg>, <arg><named-E><N><n>KFDIA</n></N></named-E></arg>, <arg><named-E><N><n>KLON</n></N></named-E></arg>, <arg><named-E><N><n>KTDIA</n></N></named-E></arg>, <arg><named-E><N><n>KLEV</n></N></named-E></arg>, <arg><named-E><N><n>PDELP</n></N></named-E></arg>, <arg><named-E><N><n>PAPHI</n></N></named-E></arg>, <arg><named-E><N><n>PQI</n></N></named-E></arg>, <arg><named-E><N><n>ZW_COMPENS</n></N></named-E></arg>, <arg><named-E><N><n>PDIFCQI</n></N></named-E></arg></arg-spec>)</call-stmt>

<C>! UPDATE PROFILES FROM TRANSPORT FLUXES.</C>
<do-stmt>DO <do-V><named-E><N><n>JLEV</n></N></named-E></do-V> = <lower-bound><named-E><N><n>KTDIA</n></N></named-E></lower-bound>, <upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></do-stmt>
  <do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V> = <lower-bound><named-E><N><n>KIDIA</n></N></named-E></lower-bound>, <upper-bound><named-E><N><n>KFDIA</n></N></named-E></upper-bound></do-stmt>
    <a-stmt><E-1><named-E><N><n>ZQLC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>ZQLC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>-</o></op><op-E><named-E><N><n>RG</n></N></named-E><op><o>*</o></op><op-E><parens-E>(<cnt>&amp;</cnt>
      <cnt>&amp;</cnt><op-E><op-E><op><o>+</o></op><named-E><N><n>PDIFCQLC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E><op><o>-</o></op><named-E><N><n>PDIFCQLC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><op-E><named-E><N><n>JLEV</n></N></named-E><op><o>-</o></op><literal-E><l>1</l></literal-E></op-E></element></element-LT>)</parens-R></R-LT></named-E></op-E> <cnt>&amp;</cnt>
      <cnt>&amp;</cnt>)</parens-E><op><o>*</o></op><op-E><named-E><N><n>PRDELP</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>YRPHY2</n></N><R-LT><component-R>%<ct>TSPHY</ct></component-R></R-LT></named-E></op-E></op-E></op-E></op-E></E-2></a-stmt>
    <a-stmt><E-1><named-E><N><n>ZQIC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>ZQIC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>-</o></op><op-E><named-E><N><n>RG</n></N></named-E><op><o>*</o></op><op-E><parens-E>(<cnt>&amp;</cnt>
      <cnt>&amp;</cnt><op-E><op-E><op><o>+</o></op><named-E><N><n>PDIFCQIC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E><op><o>-</o></op><named-E><N><n>PDIFCQIC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><op-E><named-E><N><n>JLEV</n></N></named-E><op><o>-</o></op><literal-E><l>1</l></literal-E></op-E></element></element-LT>)</parens-R></R-LT></named-E></op-E> <cnt>&amp;</cnt>
      <cnt>&amp;</cnt>)</parens-E><op><o>*</o></op><op-E><named-E><N><n>PRDELP</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>YRPHY2</n></N><R-LT><component-R>%<ct>TSPHY</ct></component-R></R-LT></named-E></op-E></op-E></op-E></op-E></E-2></a-stmt>
  <end-do-stmt>ENDDO</end-do-stmt>
<end-do-stmt>ENDDO</end-do-stmt>

<C>!-------------------------------------------------</C>
<C>! PRODUCE ICING OF CONVECTIVE LIQUID WATER TRANSPORTED BY THE UPDRAFT.</C>
<C>!-------------------------------------------------</C>

<do-stmt>DO <do-V><named-E><N><n>JLEV</n></N></named-E></do-V> = <lower-bound><named-E><N><n>KTDIA</n></N></named-E></lower-bound>, <upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></do-stmt>
  <do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V> = <lower-bound><named-E><N><n>KIDIA</n></N></named-E></lower-bound>, <upper-bound><named-E><N><n>KFDIA</n></N></named-E></upper-bound></do-stmt>
    <a-stmt><E-1><named-E><N><n>ZQLCONVPREC</n></N></named-E></E-1><a>=</a><E-2><named-E><N><n>ZQLC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-2></a-stmt>
    <a-stmt><E-1><named-E><N><n>ZUDQC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>ZQLC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>+</o></op><named-E><N><n>ZQIC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></E-2></a-stmt>
    <a-stmt><E-1><named-E><N><n>ZICE</n></N></named-E></E-1><a>=</a><E-2><named-E><N><n>FONICE</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>PTU</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-2></a-stmt>
    <a-stmt><E-1><named-E><N><n>ZQLC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>ZUDQC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><parens-E>(<op-E><literal-E><l>1.0</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E><op><o>-</o></op><named-E><N><n>ZICE</n></N></named-E></op-E>)</parens-E></op-E></E-2></a-stmt>
    <a-stmt><E-1><named-E><N><n>ZQIC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>ZUDQC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>ZICE</n></N></named-E></op-E></E-2></a-stmt>
    <a-stmt><E-1><named-E><N><n>ZTCVIM</n></N></named-E></E-1><a>=</a><E-2><op-E><parens-E>(<op-E><named-E><N><n>ZQLC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>-</o></op><named-E><N><n>ZQLCONVPREC</n></N></named-E></op-E>)</parens-E><op><o>/</o></op><named-E><N><n>YRPHY2</n></N><R-LT><component-R>%<ct>TSPHY</ct></component-R></R-LT></named-E></op-E></E-2></a-stmt>
    <a-stmt><E-1><named-E><N><n>PFIMCC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>PFIMCC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><op-E><named-E><N><n>JLEV</n></N></named-E><op><o>-</o></op><literal-E><l>1</l></literal-E></op-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>-</o></op><op-E><named-E><N><n>PDELP</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>/</o></op><op-E><named-E><N><n>RG</n></N></named-E><op><o>*</o></op><named-E><N><n>ZTCVIM</n></N></named-E></op-E></op-E></op-E></E-2></a-stmt>
  <end-do-stmt>ENDDO</end-do-stmt>
<end-do-stmt>ENDDO</end-do-stmt>
<C>!</C>
<C>! CUMULATE DEPTH OF LAYERS WHERE VERTICAL VELOCITY IS GREATER THAN A GIVEN THRESHOLD.</C>
<do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V> = <lower-bound><literal-E><l>1</l></literal-E></lower-bound>, <upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></do-stmt>
<a-stmt><E-1><named-E><N><n>ZDEPTH</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a> <E-2><literal-E><l>0.</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></E-2></a-stmt>
<end-do-stmt>ENDDO</end-do-stmt>

<do-stmt>DO <do-V><named-E><N><n>JLEV</n></N></named-E></do-V>=<lower-bound><named-E><N><n>KTDIA</n></N></named-E></lower-bound>,<upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></do-stmt>
   <do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V>=<lower-bound><named-E><N><n>KIDIA</n></N></named-E></lower-bound>,<upper-bound><named-E><N><n>KFDIA</n></N></named-E></upper-bound></do-stmt>
      <C>! CONVECTIVE CLOUD DEPTH:</C>
      <C>! CUMULATE DEPTH OF LAYERS WHERE VERTICAL VELOCITY IS GREATER THAN A GIVEN THRESHOLD.</C>
      <a-stmt><E-1><named-E><N><n>ZDEPTH</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>ZDEPTH</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>+</o></op><op-E><parens-E>(<op-E><named-E><N><n>PAPHI</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><op-E><named-E><N><n>JLEV</n></N></named-E><op><o>-</o></op><literal-E><l>1</l></literal-E></op-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>-</o></op><named-E><N><n>PAPHI</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E>)</parens-E><op><o>/</o></op><op-E><named-E><N><n>RG</n></N></named-E> <cnt>&amp;</cnt>
        <cnt>&amp;</cnt><op><o>*</o></op><named-E><N><n>MAX</n></N><R-LT><parens-R>(<element-LT><element><literal-E><l>0.</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></element>,<element><named-E><N><n>SIGN</n></N><R-LT><parens-R>(<element-LT><element><literal-E><l>1.</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></element>,<element><op-E><named-E><N><n>ZUDW</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>-</o></op><literal-E><l>1.0</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></op-E></element></element-LT>)</parens-R></R-LT></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></op-E></op-E></E-2></a-stmt>
   <end-do-stmt>ENDDO</end-do-stmt>
<end-do-stmt>ENDDO</end-do-stmt>

<C>!-------------------------------------------------</C>
<C>! The PCMT call above has computed both non-precipitating and precipitating convection fluxes.</C>
<C>! If a separate shallow convection scheme is activated in the current physics,</C>
<C>! one suppresses PCMT fluxes where PCMT convection is non-precipitating.</C>
<C>!-------------------------------------------------</C>
<if-then-stmt>IF(<condition-E><op-E><named-E><N><n>YRPHY</n></N><R-LT><component-R>%<ct>LCVPPKF</ct></component-R></R-LT></named-E><op><o>.OR.</o></op><named-E><N><n>YRPHY</n></N><R-LT><component-R>%<ct>LEDKF</ct></component-R></R-LT></named-E></op-E></condition-E>) THEN</if-then-stmt>
  <C>! PAIPCMT: Activity Index of PCMT: 1. if PCMT is active, 0. else case.</C>
  <do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V>=<lower-bound><named-E><N><n>KIDIA</n></N></named-E></lower-bound>,<upper-bound><named-E><N><n>KFDIA</n></N></named-E></upper-bound></do-stmt>
    <a-stmt><E-1><named-E><N><n>PAIPCMT</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><named-E><N><n>MAX</n></N><R-LT><parens-R>(<element-LT><element><literal-E><l>0.</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></element>,<element><named-E><N><n>SIGN</n></N><R-LT><parens-R>(<element-LT><element><literal-E><l>1.</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></element>,<element><op-E><named-E><N><n>ZDEPTH</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>-</o></op><named-E><N><n>YRPHY0</n></N><R-LT><component-R>%<ct>THPCMT</ct></component-R></R-LT></named-E></op-E></element></element-LT>)</parens-R></R-LT></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-2></a-stmt>
  <end-do-stmt>ENDDO</end-do-stmt>
<C>!  ! Is PCMT convection precipitating?</C>
<C>!  ZMAX(:)=0._JPRB</C>
<C>!  DO JLEV=KTDIA,KLEV</C>
<C>!    DO JLON=KIDIA,KFDIA</C>
<C>!      ZMAX(JLON)=MAX(ZMAX(JLON),PQRCONV(JLON,JLEV)+PQSCONV(JLON,JLEV))</C>
<C>!    ENDDO</C>
<C>!  ENDDO</C>
<C>!  ! PAIPCMT: Activity Index of PCMT: 1. if PCMT is active, 0. else case.</C>
<C>!  DO JLON=KIDIA,KFDIA</C>
<C>!    PAIPCMT(JLON)=MAX(0._JPRB,SIGN(1._JPRB,ZMAX(JLON)-THPCMT))</C>
<C>!  ENDDO</C>
  <C>! One applies the PAIPCMT activity index to the PCMT fluxes.</C>
  <do-stmt>DO <do-V><named-E><N><n>JLEV</n></N></named-E></do-V>=<lower-bound><op-E><named-E><N><n>KTDIA</n></N></named-E><op><o>-</o></op><literal-E><l>1</l></literal-E></op-E></lower-bound>,<upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></do-stmt>
    <do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V>=<lower-bound><named-E><N><n>KIDIA</n></N></named-E></lower-bound>,<upper-bound><named-E><N><n>KFDIA</n></N></named-E></upper-bound></do-stmt>
      <a-stmt><E-1><named-E><N><n>PDIFCQ</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>PAIPCMT</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>PDIFCQ</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></E-2></a-stmt>
      <a-stmt><E-1><named-E><N><n>PDIFCQL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>PAIPCMT</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>PDIFCQL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></E-2></a-stmt>
      <a-stmt><E-1><named-E><N><n>PDIFCQI</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>PAIPCMT</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>PDIFCQI</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></E-2></a-stmt>
      <a-stmt><E-1><named-E><N><n>PDIFCQLC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>PAIPCMT</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>PDIFCQLC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></E-2></a-stmt>
      <a-stmt><E-1><named-E><N><n>PDIFCQIC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>PAIPCMT</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>PDIFCQIC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></E-2></a-stmt>
      <a-stmt><E-1><named-E><N><n>PDIFCS</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>PAIPCMT</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>PDIFCS</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></E-2></a-stmt>
      <a-stmt><E-1><named-E><N><n>PDIFCTH</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>PAIPCMT</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>PDIFCTH</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></E-2></a-stmt>
      <a-stmt><E-1><named-E><N><n>PFCCQL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>PAIPCMT</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>PFCCQL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></E-2></a-stmt>
      <a-stmt><E-1><named-E><N><n>PFCCQN</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>PAIPCMT</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>PFCCQN</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></E-2></a-stmt>
      <a-stmt><E-1><named-E><N><n>PSTRCU</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>PAIPCMT</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>PSTRCU</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></E-2></a-stmt>
      <a-stmt><E-1><named-E><N><n>PSTRCV</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>PAIPCMT</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>PSTRCV</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></E-2></a-stmt>
      <a-stmt><E-1><named-E><N><n>PFIMCC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>PAIPCMT</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>PFIMCC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></E-2></a-stmt>
      <a-stmt><E-1><named-E><N><n>PFPEVPCL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>PAIPCMT</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>PFPEVPCL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></E-2></a-stmt>
      <a-stmt><E-1><named-E><N><n>PFPEVPCN</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>PAIPCMT</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>PFPEVPCN</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></E-2></a-stmt>
      <a-stmt><E-1><named-E><N><n>PFPLCL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>PAIPCMT</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>PFPLCL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></E-2></a-stmt>
      <a-stmt><E-1><named-E><N><n>PFPLCN</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>PAIPCMT</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>PFPLCN</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></E-2></a-stmt>
      <a-stmt><E-1><named-E><N><n>PFPFPCL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>PAIPCMT</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>PFPFPCL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></E-2></a-stmt>
      <a-stmt><E-1><named-E><N><n>PFPFPCN</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>PAIPCMT</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>PFPFPCN</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></E-2></a-stmt>
      <a-stmt><E-1><named-E><N><n>PFEDQLC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>PAIPCMT</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>PFEDQLC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></E-2></a-stmt>
      <a-stmt><E-1><named-E><N><n>PFEDQIC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>PAIPCMT</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>PFEDQIC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></E-2></a-stmt>
      <a-stmt><E-1><named-E><N><n>PFEDQRC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>PAIPCMT</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>PFEDQRC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></E-2></a-stmt>
      <a-stmt><E-1><named-E><N><n>PFEDQSC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>PAIPCMT</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>PFEDQSC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></E-2></a-stmt>
      <a-stmt><E-1><named-E><N><n>PFCNEGQLC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>PAIPCMT</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>PFCNEGQLC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></E-2></a-stmt>
      <a-stmt><E-1><named-E><N><n>PFCNEGQIC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>PAIPCMT</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>PFCNEGQIC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></E-2></a-stmt>
      <a-stmt><E-1><named-E><N><n>PFCNEGQRC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>PAIPCMT</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>PFCNEGQRC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></E-2></a-stmt>
      <a-stmt><E-1><named-E><N><n>PFCNEGQSC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>PAIPCMT</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>PFCNEGQSC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></E-2></a-stmt>
    <end-do-stmt>ENDDO</end-do-stmt>
  <end-do-stmt>ENDDO</end-do-stmt>
  <do-stmt>DO <do-V><named-E><N><n>JTRA</n></N></named-E></do-V> = <lower-bound><literal-E><l>1</l></literal-E></lower-bound>, <upper-bound><named-E><N><n>KTRA</n></N></named-E></upper-bound></do-stmt>
    <do-stmt>DO <do-V><named-E><N><n>JLEV</n></N></named-E></do-V>=<lower-bound><named-E><N><n>KTDIA</n></N></named-E></lower-bound>,<upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></do-stmt>
      <do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V>=<lower-bound><named-E><N><n>KIDIA</n></N></named-E></lower-bound>,<upper-bound><named-E><N><n>KFDIA</n></N></named-E></upper-bound></do-stmt>
          <a-stmt><E-1><named-E><N><n>PSTRCTRA</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element>,<element><named-E><N><n>JTRA</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>PAIPCMT</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>PSTRCTRA</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element>,<element><named-E><N><n>JTRA</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></E-2></a-stmt>
      <end-do-stmt>ENDDO</end-do-stmt>
    <end-do-stmt>ENDDO</end-do-stmt>
  <end-do-stmt>ENDDO</end-do-stmt>
  <do-stmt>DO <do-V><named-E><N><n>JLEV</n></N></named-E></do-V>=<lower-bound><named-E><N><n>KTDIA</n></N></named-E></lower-bound>,<upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></do-stmt>
    <do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V>=<lower-bound><named-E><N><n>KIDIA</n></N></named-E></lower-bound>,<upper-bound><named-E><N><n>KFDIA</n></N></named-E></upper-bound></do-stmt>
      <a-stmt><E-1><named-E><N><n>PNEBC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>PAIPCMT</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>PNEBC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></E-2></a-stmt>
      <a-stmt><E-1><named-E><N><n>PQLIC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>PAIPCMT</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>*</o></op><named-E><N><n>PQLIC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></op-E></E-2></a-stmt>
    <end-do-stmt>ENDDO</end-do-stmt>
  <end-do-stmt>ENDDO</end-do-stmt>
<else-stmt>ELSE</else-stmt>
  <C>! One has called the PCMT scheme, and no external shallow convection</C>
  <C>! is activated. In this case, PCMT is expected to produce both</C>
  <C>! precipitating and non-precipitating convection fluxes,</C>
  <C>! the activity index PAIPCMT is set to 1..</C>
  <do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V> = <lower-bound><literal-E><l>1</l></literal-E></lower-bound>, <upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></do-stmt>
<a-stmt><E-1><named-E><N><n>ZDEPTH</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a> <E-2><literal-E><l>0.</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></E-2></a-stmt>
<end-do-stmt>ENDDO</end-do-stmt>

  <do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V> = <lower-bound><literal-E><l>1</l></literal-E></lower-bound>, <upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></do-stmt>
<a-stmt><E-1><named-E><N><n>PAIPCMT</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a> <E-2><literal-E><l>1.</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></E-2></a-stmt>
<end-do-stmt>ENDDO</end-do-stmt>

<end-if-stmt>ENDIF</end-if-stmt>

<if-then-stmt>IF(<condition-E><op-E><named-E><N><n>YRPHY0</n></N><R-LT><component-R>%<ct>NCVCLOS</ct></component-R></R-LT></named-E> <op><o>==</o></op> <literal-E><l>4</l></literal-E></op-E></condition-E>) THEN</if-then-stmt>
  <C>!</C>
  <C>!-------------------------------------------------</C>
  <C>! In case of prognostic surface active fraction, one uses the PUDAL array</C>
  <C>! to advect ZALF surface active fraction in 3D from one step to the next.</C>
  <C>!-------------------------------------------------</C>
  <C>!</C>
  <do-stmt>DO <do-V><named-E><N><n>JLEV</n></N></named-E></do-V> = <lower-bound><named-E><N><n>KTDIA</n></N></named-E></lower-bound>, <upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></do-stmt>
    <do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V> = <lower-bound><named-E><N><n>KIDIA</n></N></named-E></lower-bound>, <upper-bound><named-E><N><n>KFDIA</n></N></named-E></upper-bound></do-stmt>
      <a-stmt><E-1><named-E><N><n>PUDAL</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1> <a>=</a> <E-2><named-E><N><n>ZALF</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-2></a-stmt>
    <end-do-stmt>ENDDO</end-do-stmt>
  <end-do-stmt>ENDDO</end-do-stmt>
<end-if-stmt>ENDIF</end-if-stmt>

<C>!</C>
<C>!-------------------------------------------------</C>
<C>! PCSGC: resolved condensates located Close to SubGrid Convection: 1. if close, 0. if &quot;far&quot;.</C>
<C>!-------------------------------------------------</C>
<C>!</C>
<do-stmt>DO <do-V><named-E><N><n>JLEV</n></N></named-E></do-V> = <lower-bound><literal-E><l>1</l></literal-E></lower-bound>, <upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></do-stmt>
<do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V> = <lower-bound><literal-E><l>1</l></literal-E></lower-bound>, <upper-bound><named-E><N><n>KLON</n></N></named-E></upper-bound></do-stmt>
<a-stmt><E-1><named-E><N><n>PCSGC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a> <E-2><literal-E><l>1.</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></E-2></a-stmt>
<end-do-stmt>ENDDO</end-do-stmt>
<end-do-stmt>ENDDO</end-do-stmt>

<do-stmt>DO <do-V><named-E><N><n>JLEV</n></N></named-E></do-V>=<lower-bound><named-E><N><n>KTDIA</n></N></named-E></lower-bound>,<upper-bound><named-E><N><n>KLEV</n></N></named-E></upper-bound></do-stmt>
  <do-stmt>DO <do-V><named-E><N><n>JLON</n></N></named-E></do-V>=<lower-bound><named-E><N><n>KIDIA</n></N></named-E></lower-bound>,<upper-bound><named-E><N><n>KFDIA</n></N></named-E></upper-bound></do-stmt>
    <a-stmt><E-1><named-E><N><n>ZFRACP</n></N></named-E></E-1><a>=</a><E-2><named-E><N><n>EXP</n></N><R-LT><parens-R>(<element-LT><element><op-E><parens-E>(<op-E><named-E><N><n>PAPRSF</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>-</o></op><named-E><N><n>YRPHY0</n></N><R-LT><component-R>%<ct>GCVFNEP1</ct></component-R></R-LT></named-E></op-E>)</parens-E><op><o>/</o></op><named-E><N><n>YRPHY0</n></N><R-LT><component-R>%<ct>GCVFNEP2</ct></component-R></R-LT></named-E></op-E></element></element-LT>)</parens-R></R-LT></named-E></E-2></a-stmt>
    <a-stmt><E-1><named-E><N><n>ZTH</n></N></named-E></E-1><a>=</a><E-2><op-E><parens-E>(<op-E><op-E><named-E><N><n>ZFRACP</n></N></named-E><op><o>*</o></op><named-E><N><n>ZFRACP</n></N></named-E></op-E><op><o>-</o></op><literal-E><l>1.</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></op-E>)</parens-E><op><o>/</o></op><parens-E>(<op-E><op-E><named-E><N><n>ZFRACP</n></N></named-E><op><o>*</o></op><named-E><N><n>ZFRACP</n></N></named-E></op-E><op><o>+</o></op><literal-E><l>1.</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></op-E>)</parens-E></op-E></E-2></a-stmt>
    <a-stmt><E-1><named-E><N><n>PCSGC</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element>,<element><named-E><N><n>JLEV</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E></E-1><a>=</a><E-2><op-E><named-E><N><n>YRPHY0</n></N><R-LT><component-R>%<ct>GCVFNER</ct></component-R></R-LT></named-E><op><o>*</o></op><op-E><named-E><N><n>MAX</n></N><R-LT><parens-R>(<element-LT><element><literal-E><l>0.</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></element>,<element><named-E><N><n>SIGN</n></N><R-LT><parens-R>(<element-LT><element><literal-E><l>1.</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E></element>,<element><op-E><named-E><N><n>ZDEPTH</n></N><R-LT><parens-R>(<element-LT><element><named-E><N><n>JLON</n></N></named-E></element></element-LT>)</parens-R></R-LT></named-E><op><o>-</o></op><named-E><N><n>YRPHY0</n></N><R-LT><component-R>%<ct>GCVFNEO</ct></component-R></R-LT></named-E></op-E></element></element-LT>)</parens-R></R-LT></named-E></element></element-LT>)</parens-R></R-LT></named-E> <cnt>&amp;</cnt>
      <cnt>&amp;</cnt> <op><o>*</o></op><op-E><literal-E><l>0.5</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E><op><o>*</o></op><parens-E>(<op-E><literal-E><l>1.</l><K-spec>_<N><n>JPRB</n></N></K-spec></literal-E><op><o>-</o></op><named-E><N><n>ZTH</n></N></named-E></op-E>)</parens-E></op-E></op-E></op-E></E-2></a-stmt>
  <end-do-stmt>ENDDO</end-do-stmt>
<end-do-stmt>ENDDO</end-do-stmt>


<end-subroutine-stmt>END SUBROUTINE <subroutine-N><N><n>ACPCMT</n></N></subroutine-N></end-subroutine-stmt>

</file></object>
